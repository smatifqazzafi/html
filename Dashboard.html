<script src="MyAssets/Scripts/chart_chartLibraray.js"></script>
<script src="MyAssets/Scripts/chart_chartDrildown.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="MyAssets/Scripts/chart_chartAccessibility.js"></script>

<style>
    body {
        font-family: 'Roboto', sans-serif;
        background: linear-gradient(to bottom right, #f0f0f0, #ffffff);
        margin: 0;
        padding: 0;
    }

    .chart-container {
        width: 100%;
        height: 300px;
        margin: 5px;
        border-radius: 10px;
        border: 2px solid var(--colors_materialmenu_selecteditemforecolor);
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        background: #fff;
        float: left;
        margin-left: 0px;
    }

    .chart-row {
        margin-bottom: 10px;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start;
    }

    .highcharts-xaxis-labels text {
        text-decoration: none !important;
        fill: var(--colors_materialmenu_selecteditembackground) !important;
    }


    .highcharts-xaxis-labels {
        color: Yellow !important
    }

    .chart-dropdown {
        display: flex;
        justify-content: right;
        margin-bottom: 10px;
        font-family: Arial, sans-serif;
    }

    .chart-dropdown label {
        font-weight: bold;
        margin-right: 5px;
        color: var(--colors_materialmenu_selecteditembackground);
    }

    .chart-dropdown select {
        padding: 5px;
        border-radius: 5px;
        border: 1px solid var(--colors_materialmenu_selecteditembackground);
        outline: none;
        cursor: pointer;
        color: var(--colors_materialmenu_selecteditembackground);
    }

    .highcharts-credits {
        display: none !important;
    }

    .TextBlock {
        padding: 0px !important;
        margin: 0px !important;
    }

    @media (max-width: 768px) {
        .TextBlockDashboardDescriptionCard {
            font-size: 9px;
        }
    }

    @media (max-width: 386px) {
        .TextBlockDashboardDescriptionCard {
            font-size: 7.5px;
        }
    }

    .ProgressCardIcon {
        color: white;
    }

    .panel-body {
        padding-top: 15px;
        padding-bottom: 4px
    }

    /*.panel-collapse {
        background-color: var(--colors_materialmenu_selecteditembackground);
        color: white !important
    }*/

    .TextBlockDashboardDescriptionCard {
        color: var(--colors_materialmenu_selecteditemforecolor)
    }

    .DashboardNumberCardNoBorder {
        color: var(--colors_materialmenu_selecteditemforecolor)
    }

    #PanelBody_DVPANEL_P1Container {
        background-color: var(--colors_materialmenu_selecteditembackground);
    }

    #PanelBody_DVPANEL_P2Container {
        background-color: #058a22;
    }

    #PanelBody_DVPANEL_P3Container {
        background-color: #02968a;
    }

    #DVPANEL_P4Containerp4 {
        background-color: #78c0e0;
    }


    [tabindex='-1']:focus {
        outline: 0 !important;
    }

    h2,
    h5 {
        margin-top: 0;
        margin-bottom: .5rem;
    }

    p {
        margin-top: 0;
        margin-bottom: 1rem;
    }

    dfn {
        font-style: italic;
    }

    strong {
        font-weight: bolder;
    }



    #TABLEHEADER_MPAGE {
        height: 0px !important
    }



    caption {
        padding-top: 1rem;
        padding-bottom: 1rem;
        caption-side: bottom;
        text-align: left;
        color: #8898aa;
    }

    input,
    button {
        font-family: inherit;
        font-size: inherit;
        line-height: inherit;
        margin: 0;
    }

    button,
    input {
        overflow: visible;
    }

    button {
        text-transform: none;
    }

    button,
    [type='reset'],
    [type='submit'] {
        -webkit-appearance: button;
    }

    button::-moz-focus-inner,
    [type='button']::-moz-focus-inner,
    [type='reset']::-moz-focus-inner,
    [type='submit']::-moz-focus-inner {
        padding: 0;
        border-style: none;
    }

    input[type='radio'],
    input[type='checkbox'] {
        box-sizing: border-box;
        padding: 0;
    }

    input[type='date'],
    input[type='time'],
    input[type='datetime-local'],
    input[type='month'] {
        -webkit-appearance: listbox;
    }

    legend {
        font-size: 1.5rem;
        line-height: inherit;
        display: block;
        width: 100%;
        max-width: 100%;
        margin-bottom: .5rem;
        padding: 0;
        white-space: normal;
        color: inherit;
    }

    [type='number']::-webkit-inner-spin-button,
    [type='number']::-webkit-outer-spin-button {
        height: auto;
    }

    [type='search'] {
        outline-offset: -2px;
        -webkit-appearance: none;
    }

    [type='search']::-webkit-search-cancel-button,
    [type='search']::-webkit-search-decoration {
        -webkit-appearance: none;
    }

    ::-webkit-file-upload-button {
        font: inherit;
        -webkit-appearance: button;
    }

    [hidden] {
        display: none !important;
    }

    h2,
    h5,
    .h2,
    .h5 {
        font-family: inherit;
        font-weight: 400 !important;
        line-height: 1.1;
        margin-bottom: .5rem;
        color: #32325d;
    }

    h2,
    .h2 {
        font-size: 1.25rem;
    }

    h5,
    .h5 {
        font-size: .8125rem;
    }

    .container-fluid {
        width: 100%;
        margin-right: auto;
        margin-left: auto;
        padding-right: 15px;
        padding-left: 15px;
    }

    .row {
        display: flex;
        margin-right: -15px;
        margin-left: -15px;
        flex-wrap: wrap;
    }

    .col,
    .col-auto,
    .col-lg-6,
    .col-xl-3,
    .col-xl-6 {
        position: relative;
        width: 100%;
        min-height: 1px;
        padding-right: 15px;
        padding-left: 15px;
    }

    .col {
        max-width: 100%;
        flex-basis: 0;
        flex-grow: 1;
    }

    .col-auto {
        width: auto;
        max-width: none;
        flex: 0 0 auto;
    }

    @media (min-width: 992px) {
        .col-lg-6 {
            max-width: 50%;
            flex: 0 0 50%;
        }
    }

    @media (min-width: 1200px) {
        .col-xl-3 {
            max-width: 25%;
            flex: 0 0 25%;
        }

        .col-xl-6 {
            max-width: 50%;
            flex: 0 0 50%;
        }
    }

    .card {
        position: relative;
        display: flex;
        flex-direction: column;
        min-width: 0;
        word-wrap: break-word;
        border: 1px solid rgba(0, 0, 0, .05);
        border-radius: .375rem;
        background-color: #fff;
        background-clip: border-box;
    }

    h5.card-title.text-uppercase.text-muted.mb-0 {
        font-weight: 500 !important;
    }

    .card-body {
        padding: 1.5rem;
        flex: 1 1 auto;
    }

    .card-title {
        font-family: var(--fonts_primary-regular);
        font-size: var(--fontsizes_s);
        font-weight: normal;
    }

    .chart-containers {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 80vh;
        position: relative;
        width: 98%;
        margin-left: 15px;
    }

    .loader {
        border: 8px solid #f3f3f3;
        /* Light grey */
        border-top: 8px solid var(--colors_materialmenu_selecteditembackground);
        /* Blue */
        border-radius: 50%;
        width: 60px;
        height: 60px;
        animation: spin 2s linear infinite;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .hide-loader {
        display: none;
    }

    @keyframes progress-bar-stripes {
        from {
            background-position: 1rem 0;
        }

        to {
            background-position: 0 0;
        }
    }

    .bg-info {
        background-color: #11cdef !important;
    }

    a.bg-info:hover,
    a.bg-info:focus,
    button.bg-info:hover,
    button.bg-info:focus {
        background-color: #0da5c0 !important;
    }

    .bg-warning {
        background-color: #058a22 !important;
    }

    a.bg-warning:hover,
    a.bg-warning:focus,
    button.bg-warning:hover,
    button.bg-warning:focus {
        background-color: #fa3a0e !important;
    }

    .bg-danger {
        background-color: #b9b26a !important;
    }

    a.bg-danger:hover,
    a.bg-danger:focus,
    button.bg-danger:hover,
    button.bg-danger:focus {
        background-color: #ec0c38 !important;
    }

    .bg-default {
        background-color: #172b4d !important;
    }

    a.bg-default:hover,
    a.bg-default:focus,
    button.bg-default:hover,
    button.bg-default:focus {
        background-color: #0b1526 !important;
    }

    .rounded-circle {
        border-radius: 50% !important;
    }

    .align-items-center {
        align-items: center !important;
    }

    @media (min-width: 1200px) {
        .justify-content-xl-between {
            justify-content: space-between !important;
        }
    }

    .shadow {
        box-shadow: 0 0 2rem 0 rgba(136, 152, 170, .15) !important;
    }

    .mb-0 {
        margin-bottom: 0 !important;
    }

    .mr-2 {
        margin-right: .5rem !important;
    }

    .mt-3 {
        margin-top: 1rem !important;
    }

    .mb-4 {
        margin-bottom: 1.5rem !important;
    }

    .mb-5 {
        margin-bottom: 3rem !important;
    }

    .pt-5 {
        padding-top: 3rem !important;
    }

    .pb-8 {
        padding-bottom: 8rem !important;
    }

    .m-auto {
        margin: auto !important;
    }

    @media (min-width: 768px) {
        .pt-md-8 {
            padding-top: 8rem !important;
        }
    }

    @media (min-width: 1200px) {
        .mb-xl-0 {
            margin-bottom: 0 !important;
        }
    }

    .text-nowrap {
        white-space: nowrap !important;
    }

    .text-center {
        text-align: center !important;
    }

    .text-uppercase {
        text-transform: uppercase !important;
    }

    .font-weight-bold {
        font-weight: 600 !important;
    }

    .text-white {
        color: #fff !important;
    }

    .text-success {
        color: #2dce89 !important;
    }

    a.text-success:hover,
    a.text-success:focus {
        color: #24a46d !important;
    }

    .text-warning {
        color: #058a22 !important;
    }

    a.text-warning:hover,
    a.text-warning:focus {
        color: #fa3a0e !important;
    }

    .text-danger {
        color: #b9b26a !important;
    }

    a.text-danger:hover,
    a.text-danger:focus {
        color: #ec0c38 !important;
    }

    .text-white {
        color: #fff !important;
    }

    a.text-white:hover,
    a.text-white:focus {
        color: #e6e6e6 !important;
    }

    .text-muted {
        color: #8898aa !important;
    }

    figcaption,
    main {
        display: block;
    }

    main {
        overflow: hidden;
    }

    .bg-yellow {
        background-color: #ffd600 !important;
    }

    a.bg-yellow:hover,
    a.bg-yellow:focus,
    button.bg-yellow:hover,
    button.bg-yellow:focus {
        background-color: #ccab00 !important;
    }

    .bg-gradient-primary {
        background: linear-gradient(87deg, #5e72e4 0, #805ee4 100%) !important;
    }

    .bg-gradient-primary {
        background: linear-gradient(87deg, #5e72e4 0, #805ee4 100%) !important;
    }

    @keyframes floating-lg {
        0% {
            transform: translateY(0px);
        }

        50% {
            transform: translateY(15px);
        }

        100% {
            transform: translateY(0px);
        }
    }

    @keyframes floating {
        0% {
            transform: translateY(0px);
        }

        50% {
            transform: translateY(10px);
        }

        100% {
            transform: translateY(0px);
        }
    }

    @keyframes floating-sm {
        0% {
            transform: translateY(0px);
        }

        50% {
            transform: translateY(5px);
        }

        100% {
            transform: translateY(0px);
        }
    }

    [class*='shadow'] {
        transition: all .15s ease;
    }

    .text-sm {
        font-size: .875rem !important;
    }

    .text-white {
        color: #fff !important;
    }

    a.text-white:hover,
    a.text-white:focus {
        color: #e6e6e6 !important;
    }

    [class*='btn-outline-'] {
        border-width: 1px;
    }

    .card-stats .card-body {
        padding: 1rem 1.5rem;
    }

    .main-content {
        position: relative;
    }



    .footer {
        padding: 2.5rem 0;
        background: #f7fafc;
    }

    .footer .copyright {
        font-size: .875rem;
    }

    .header {
        position: relative;
    }

    .icon {
        width: 3rem;
        height: 3rem;
    }

    .icon i {
        font-size: 2.25rem;
    }

    .icon-shape {
        display: inline-flex;
        padding: 12px;
        text-align: center;
        border-radius: 50%;
        align-items: center;
        justify-content: center;
    }

    .icon-shape i {
        font-size: 1.25rem;
    }

    p {
        font-size: 1rem;
        font-weight: 300;
        line-height: 1.7;
    }


    .card_1 {
        background-color: #177a9a24;
        border: 2px solid #177a9a;
        box-shadow: 2px 2px 5px #00000063;
    }

    .card_2 {
        background-color: #f1c0932b;
        border: 2px solid #fe8612;
        box-shadow: 2px 2px 5px #00000063;
        /* background: linear-gradient(to right, #02968a, #5486d1); */
    }

    .card_3 {
        background-color: #058a2220;
        border: 2px solid #058a22;
        box-shadow: 2px 2px 5px #00000063;
    }

    .card_4 {
        background-color: #76407a29;
        border: 2px solid #76407a;
        box-shadow: 2px 2px 5px #00000063;
    }

    .card_5-match {
        background-color: #058a2220;
        border: 2px solid #058a22;
        box-shadow: 2px 2px 5px #00000063;
    }

    .card_6-proposed {
        background-color: #f1c0932b;
        border: 2px solid #fe8612;
        box-shadow: 2px 2px 5px #00000063;
    }

    .card_7-unMatched {
        background-color: #b70e0e29;
        border: 2px solid #bd1c1c;
        box-shadow: 2px 2px 5px #00000063;
    }

    .chart-containerCircel-matched {
        height: 73px;
        background-color: #058a2220;
        border: 2px solid #058a22;
        box-shadow: 2px 2px 5px #00000063;
    }

    .chart-containerCircel-proposed {
        height: 73px;
        background-color: #f1c0932b;
        border: 2px solid #fe8612;
        box-shadow: 2px 2px 5px #00000063;
    }

    .chart-containerCircel-unmatched {
        height: 73px;
        background-color: #e2cfd3;
        border: 2px solid #bd1c1c;
        box-shadow: 2px 2px 5px #00000063;
    }

    .icon-shape-matched {
        display: inline-flex;
        padding: 12px;
        text-align: center;
        border-radius: 50%;
        align-items: center;
        justify-content: center;
        background-color: #058a22;
    }

    .icon-shape-proposed {
        display: inline-flex;
        padding: 12px;
        text-align: center;
        border-radius: 50%;
        align-items: center;
        justify-content: center;
        background-color: #eba421;
    }

    .icon-shape-unmatched {
        display: inline-flex;
        padding: 12px;
        text-align: center;
        border-radius: 50%;
        align-items: center;
        justify-content: center;
        background-color: #cd1717;
    }

    .stroke-matched {
        stroke: #058a22;
    }

    .stroke-proposed {
        stroke: #fe8612;
    }

    .stroke-unmatched {
        stroke: #d51956;
    }

    #digital .right ul .bar {
        height: .4rem;
        position: relative;
        list-style: none;
        border-radius: 10px;
        margin: 3rem 0;
        animation: skills;
        animation-duration: 1s;
    }

    #digital .right ul .html {
        width: 90%;
        background-color: #e54c21;
    }

    #digital .right ul .css {
        width: 80%;
        background-color: #00a0e4;
    }


    #digital .right ul .js {
        width: 70%;
        background-color: yellow;
    }

    #digital .right ul .bootstrap {
        width: 80%;
        background-color: #7952b3;
    }

    #digital .language {
        position: absolute;
        bottom: .6rem;
        left: 0;
    }

    #digital .percentage {
        position: absolute;
        bottom: .6rem;
        right: 0;
    }



    #cash .right ul .bar {
        height: .4rem;
        position: relative;
        list-style: none;
        border-radius: 10px;
        margin: 3rem 0;
        animation: skills;
        animation-duration: 1s;
    }

    #cash .right ul .html {
        width: 10.8%;
        background-color: #e54c21;
    }

    #cash .right ul .css {
        width: 80%;
        background-color: #00a0e4;
    }


    #cash .right ul .js {
        width: 70%;
        background-color: yellow;
    }

    #cash .right ul .bootstrap {
        width: 80%;
        background-color: #7952b3;
    }

    #cash .language {
        position: absolute;
        bottom: .6rem;
        left: 0;
    }

    #cash .percentage {
        position: absolute;
        bottom: .6rem;
        right: 0;
    }


    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap');

    :root {
        --app-bg-dark: #01081f;
        --app-bg-light: #151c32;
        --app-logo: #3d7eff;
        --main-color: #fff;
        --secondary-color: #5e6a81;
        --color-light: rgba(52, 129, 210, .2);
    }

    body {
        font-family: 'Poppins', sans-serif;
    }

    .chart-row {
        display: flex;
        justify-content: space-between;
        margin: 0 -8px;
    }

    .chart-containerCircel {
        justify-content: space-between;
    }

    .chart-container-wrapper {
        padding: 8px;
    }

    .chart-containerCircel {
        width: 100%;
        border-radius: 10px;
        background-color: white;
        padding: 8px 0px 8px 15px;
        display: flex;
        align-items: center;
    }

    .chart-info-wrapper {
        flex-shrink: 0;
        flex-basis: 120px;
    }

    .chart-info-wrapper h2 {
        color: var(--secondary-color);
        font-size: 10px;
        line-height: 16px;
        font-weight: 600;
        text-transform: uppercase;
        margin: 0 0 8px 0;
    }

    .chart-info-wrapper span {
        color: black;
        font-size: 1.25rem;
        line-height: 32px;
        font-weight: 500;
    }

    .chart-svg {
        position: relative;
        max-width: 65px;
        min-width: 40px;
        flex: 1;
    }

    .circle-bg {
        fill: none;
        stroke: #eee;
        stroke-width: 2px;
    }

    .circle {
        fill: none;
        stroke-width: 2px;
        stroke-linecap: round;
        animation: progress 1s ease-out forwards;
    }

    .circular-chart.orange .circle {
        stroke: #058a22;
    }



    .circular-chart.blue .circle {
        stroke: #fe8612;
    }

    .circular-chart.systemColor .circle {
        stroke: #177a9a;
    }

    .circular-chart.darklight .circle {
        stroke: #76407a !important;
    }

    .percentage {
        fill: black;
        font-size: 0.5em;
        text-anchor: middle;
        font-weight: 400;
    }

    @keyframes progress {
        0% {
            stroke-dasharray: 0 100;
        }
    }

    .progress_bar .pro-bar {
        background: hsl(0, 0%, 97%);
        box-shadow: 0 1px 2px hsla(0, 0%, 0%, 0.1) inset;
        height: 1px;
        margin-bottom: 12px;
        margin-top: 50px;
        position: relative;
    }

    .progress_bar .progress_bar_title {
        color: hsl(218, 4%, 50%);
        font-size: 15px;
        font-weight: 300;
        position: relative;
        top: -18px;
        z-index: 1;
    }

    .progress_bar .progress_number {
        float: right;
        margin-top: -24px;
    }

    .progress_bar .progress-bar-inner {
        background-color: hsl(0, 0%, 88%);
        display: block;
        width: 0;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        transition: width 1s linear 0s;
    }

    .progress_bar .progress-bar-inner:before {
        content: "";
        background-color: hsl(0, 0%, 100%);
        border-radius: 50%;
        width: 4px;
        height: 4px;
        position: absolute;
        right: 1px;
        top: 0;
        z-index: 1;
    }

    .progress_bar .progress-bar-inner:after {
        content: "";
        width: 14px;
        height: 14px;
        background-color: inherit;
        border-radius: 50%;
        position: absolute;
        right: -4px;
        top: -5px;
    }

    /*-------------------------- Popup -------------------*/

    .popupBox {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: none;
    }

    .popupBox__content {
        position: relative;
        width: 400px;
        height: 260px;
        background: #fff;
        border-radius: 30px;
        display: flex;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    }

    .popupBox__img {
        position: relative;
        width: 200px;
        height: 260px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .popupBox__img img {
        width: 70%;
    }

    .popupBox__img::before {
        content: "";
        position: absolute;
        width: 250px;
        height: 250px;
        /*background: #e7ffe0;
               border-radius: 50%;*/
    }

    .popupBox__img img {
        position: relative;
        max-width: 260px;
        z-index: 1;
    }

    .popupBox__contentTwo {
        position: relative;
        width: 270px;
        height: 260px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .popupBox__title {
        color: #333;
        line-height: 1em;
        font-weight: 300;
        font-size: 1.5em;
    }

    .popupBox__titleTwo {
        font-size: 2em;
        color: #887fff;
        line-height: 1em;
    }

    .popupBox__titleTwo span {
        color: #333;
        font-size: 0.45em;
        text-transform: uppercase;
    }

    .popupBox__description {
        font-weight: 300;
    }

    .popupBox__btn {
        display: inline-block;
        padding: 10px 20px;
        background: #887fff;
        text-decoration: none;
        color: #000;
        margin-top: 15px;
        border-radius: 10px;
    }

    .close {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
        background: #f3f3f3 url(https://www.pikpng.com/pngl/m/302-3024308_close-icon-png-x-png-icon-clipart.png);
        background-repeat: no-repeat;
        background-size: 12px;
        background-position: center;
        z-index: 10;
        cursor: pointer;
        border-radius: 50%;
    }

    @media (max-width: 768px) {
        .popupBox__content {
            width: 300px;
            height: auto;
            flex-direction: column;
        }

        .popupBox__img {
            height: 200px;
            transform: translateY(-50px);
        }

        .popupBox__contentTwo {
            height: auto;
            text-align: center;
            padding: 20px;
            padding-top: 0;
        }

        .popupBox__img::before {
            background: #fff;
        }

        .close {
            top: -50px;
            right: -10px;
            background: black url(./img/close.png);
            background-repeat: no-repeat;
            background-size: 10px;
            background-position: center;
        }
    }

    .credit a {
        text-decoration: none;
        color: #887fff;
    }

    .credit {
        margin-top: 10px;
    }




    /*============== Refersh Button ==============*/
    /* Floating Refresh Button Container */
    .floating-refresh-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
    }

    /* Material Design Button Styling */
    .material-button {
        /* background-color: #6200ea; Material Design purple color */
        /* background-color: #004000ad; */
        background-color: var(--colors_materialmenu_selecteditembackground);
        opacity: 0.8;
        color: white;
        border: none;
        padding: 12px;
        border-radius: 50%;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        /* Material-like shadow */
        cursor: pointer;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }

    /* Hover Effect */
    .material-button:hover {
        /* background-color: #3700b3; Darker purple on hover */
        /* background-color: #004000; */
        background-color: var(--colors_materialmenu_selecteditembackground);
        opacity: 2;
        box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.3);
        /* Larger shadow on hover */
    }

    /* Material Icon Styling */
    .material-icons {
        font-size: 18px;
    }





    .alert {
        background-color: #f8d7da;
        color: #721c24;
        padding: 10px;
        border: 1px solid #f5c6cb;
        border-radius: 4px;
        margin: 10px 0;
        transition: opacity 0.5s ease;
    }

    .alert.hidden {
        opacity: 0;
        pointer-events: none;
    }
</style>

<div id="customerAlert" class="alert" style="display: none;">
    This is a customer alert message!
</div>

<!--_________________________________________________________-->
<!--__________________ Show Griding _________________________-->
<!--_________________________________________________________-->
<div class="popupBox" style="z-index:9999999">
    <div class="popupBox__content">
        <div class="close"></div>
        <div class="popupBox__img">
            <img />
        </div>
        <div class="popupBox__contentTwo">
            <div>
                <h3 class="popupBox__title">Greeting </h3>
                <h2 class="popupBox__titleTwo"></h2>
            </div>
        </div>
    </div>
</div>

<div class="floating-refresh-button">
    <button class="material-button refreshBtn" type="button">
        <span class="fa fa-refresh"></span>
    </button>
</div>

<script>
    //_______________________________________
    //____________ Day Events _______________
    //_______________________________________
    function ShowGreeting() {
        const currentHour = new Date().getHours();
        let greeting = "";
        let imageUrl = "";
        const username = $.cookie('USERNAME');

        if (username) {
            if (currentHour >= 5 && currentHour < 12) {
                greeting = "Good Morning";
                imageUrl = "https://i.pinimg.com/736x/a4/34/e0/a434e03d5429430c60255a6a303fc96f.jpg";
            } else if (currentHour >= 12 && currentHour < 17) {
                greeting = "Good Afternoon";
                imageUrl = "https://st.depositphotos.com/1007168/1249/i/950/depositphotos_12492703-stock-photo-summer-hot-sun.jpg";
            } else if (currentHour >= 17 && currentHour < 21) {
                greeting = "Good Evening";
                imageUrl = "https://t3.ftcdn.net/jpg/06/36/89/50/360_F_636895063_o15toUhpNHEUa3t7DIilgpOpRWKr1iOt.jpg";
            } else {
                greeting = "Good Night";
                imageUrl = "https://png.pngtree.com/png-clipart/20230228/ourmid/pngtree-elegant-new-moon-and-stars-png-image_6623337.png";
            }

            const titleElement = document.querySelector(".popupBox__titleTwo");
            titleElement.innerHTML = `${greeting}<span> ${username}</span>`;

            const imgElement = document.querySelector(".popupBox__img img");
            imgElement.src = imageUrl;

            const popup = document.querySelector(".popupBox");
            const close = document.querySelector(".close");
            window.onload = function () {
                setTimeout(() => {
                    popup.style.display = "block";
                    setTimeout(() => {
                        $.removeCookie('USERNAME');
                        popup.style.display = "none";
                    }, 1500);

                }, 100);
            };

            close.addEventListener("click", () => {
                $.removeCookie('USERNAME');
                popup.style.display = "none";
            });
        }
    }

    ShowGreeting();
</script>

<!--_________________________________________________________-->
<!--__________________ Dividers _____________________________-->
<!--_________________________________________________________-->
<div id="ParentAlert">
</div>
<div class="accordion" id="Dashboard">
</div>

<!--_________________________________________________________-->
<!--__________________ Authorization ________________________-->
<!--_________________________________________________________-->
<script>
    var RoleName;
    var ModuleName;
    var RoleBaseModuleGloble;
    // const token = {};
    $('.floating-refresh-button').hide();

    //___________ Load Module Base UI _________________-
    function RoleLicensceBaseUI() {
        LoadRoles();
        async function LoadRoles() {
            try {
                const response = await fetch('rest/prDataStatisticeAPI_Role_LicenseModules', {
                    method: 'POST',
                    headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token }
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const apiResponse = await response.json();
                RoleBaseModuleGloble = apiResponse.SDT_ChartData_Roles_LicenseModules;
                addTemplatesUIBaseOnRole();
            } catch (error) {
                console.log('Internal Error fetching data: ' + error);
            }
        }

        function addTemplatesUIBaseOnRole() {
            LoadAlert();
            let { CurrentRole, LicenseModules } = RoleBaseModuleGloble;
            RoleName = CurrentRole;

            let hasTransformerModule = LicenseModules.some(l => l.AppModuleName === "Transformer");
            let hasDigitalModule = LicenseModules.some(l => l.AppModuleName === "Digital");
            let hasCashModule = LicenseModules.some(l => l.AppModuleName === "Cash");
            let hasSettlementModule = LicenseModules.some(l => l.AppModuleName === "Settlement");
            let hasDisputeModule = LicenseModules.some(l => l.AppModuleName === "Dispute");

            $('.floating-refresh-button').show();

            if (!hasDigitalModule && !hasCashModule && hasTransformerModule && !hasSettlementModule && !hasDisputeModule) {
                RenderTransformer();
                Transformer();
            }
            else if (!hasDigitalModule && !hasCashModule && !hasTransformerModule && hasSettlementModule && !hasDisputeModule) {
                RenderSettlement();
                Settlement();
            }
            else if (!hasDigitalModule && !hasCashModule && !hasTransformerModule && !hasSettlementModule && hasDisputeModule) {
                RenderDispute();
                Dispute();
            }
            else if (!hasDigitalModule && hasCashModule && !hasTransformerModule && !hasSettlementModule && !hasDisputeModule) {
                RenderCash();
                Cash();
            }
            else if (hasDigitalModule && !hasCashModule && !hasTransformerModule && !hasSettlementModule && !hasDisputeModule) {
                RenderDigital();
                Digital();
            } else if (hasDigitalModule && hasCashModule && hasTransformerModule && hasSettlementModule && hasDisputeModule) {
                if (CurrentRole === "Admin") {
                    RenderAdmin();
                    Transformer();
                    Digital();
                    Cash();
                    Settlement();
                    Dispute();

                } else if (CurrentRole === "Digital Admin" || CurrentRole === "Digital User") {
                    RenderDigital();
                    Digital();
                } else if (CurrentRole === "Cash Admin" || CurrentRole === "Cash User") {
                    RenderCash();
                    Cash();
                }
                else if (CurrentRole === "Transformer Admin" || CurrentRole === "Transformer User") {
                    RenderTransformer();
                    Transformer();
                }
                else if (CurrentRole === "Settlement Admin" || CurrentRole === "Settlement User") {
                    RenderSettlement();
                    Settlement();
                }
                else if (CurrentRole === "Dispute Admin" || CurrentRole === "Dispute User") {
                    RenderDispute();
                    Dispute();
                }
            }

        }

        // Render UI functions
        function RenderAdmin() {
            $("#Dashboard").append(TransformerUI('show'));
            $("#Dashboard").append(digitalUI('hidde'));
            $("#Dashboard").append(cashUI('hidde'));
            $("#Dashboard").append(SettlementUI('hidde'));
            $("#Dashboard").append(DisputeUI('hidde'));
        }

        function RenderTransformer() {
            $("#Dashboard").html(TransformerUI('show'));
        }

        function RenderDigital() {
            $("#Dashboard").html(digitalUI('show'));
        }

        function RenderCash() {
            $("#Dashboard").html(cashUI('show'));
        }

        function RenderSettlement() {
            $("#Dashboard").html(SettlementUI('show'));
        }

        function RenderDispute() {
            $("#Dashboard").html(DisputeUI('show'));
        }



        //============= UI =============
        function cashUI(toggle) { //hidde
            let DigitalHtml = `
            <!--=======================================-->
<!--============== Cash ===================-->
<!--=======================================-->
<div class="card" style="overflow:hidden;background-color:transparent;border:none">
    <div class="card-header" id="headingTwo">
        <h5 class="mb-0">
            <button type="button" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="border:none;outline:none">
                <div class="divider div-transparent"> <h2>Cash</h2></div>
            </button>
            <div class="wrapper" style="border-bottom: 2px solid var(--colors_materialmenu_selecteditembackground);margin-bottom:10px;overflow:hidden">
            </div>
        </h5>
    </div>
    <div id="collapseTwo" class="collapse ${toggle}" aria-labelledby="headingTwo" data-parent="#Dashboard" style="overflow:hidden">
        <!-- __________ Dashboard Card ______________ -->
        <div class="row" style="margin-top:5px;" id="CashTransactionCards">
        </div>
        <!-- __________ Dashboard Circle Card _______________ -->
        <div class="row" id="CashAmountCards">
        </div>
        <!-- __________ Chart ____________ -->
        <div class="row" id="progressBarStatistic">
            <div class="chart-containers">
                <div class="loader text-center" id="loader">
                </div>
            </div>

            <div class="col-xs-12 col-md-6 col-lg-4 CashOverAllChart1" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="CashOverAllChartType1">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie" selected>Pie Chart</option>
                        </select>
                    </div>
                    <div id="CashOverAllChart1"></div>
                    
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 CashOverAllChart2" style="margin-top:8px">
                <div style="background-color:white !important;width:100%;height:470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="CashOverAllChartType2">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="CashOverAllChart2"></div>
                </div>
            </div>
            

            <style>
                #CashDisputeTable tbody tr:hover {
                    cursor: pointer;
                    background-color: #f0f0f0;
                }
            </style>
            <div class="col-xs-12 col-md-6 col-lg-4 CashDisputeChart" style="margin-top: 8px; height:100%;">
                <div class="chart-container" style="height:470px; margin-left:0px;">
                    <h2 style="padding:15px 0px 0px 0px;text-align:center">Disputes</h2>
                    <div id="CashDisputeData" class="Table">
                        <div class="row">
                            <div class="col-xs-12 GridParentCell">
                                <div id="GridContainerDiv" data-gxgridid="43" class="gx-grid gx-standard-grid gx-gridGridResizableTitles" style="width: auto;">
                                    <table id="CashDisputeTable" class="gx-tab-spacing-fix-2 GridWithPaginationBar GridWithBorderColor WorkWith table-responsive" data-cellpadding="1" data-cellspacing="2">
                                        <thead>
                                            <tr>
                                                <th class="gx-tab-padding-fix-1 WWColumn GridWithPaginationBar GridWithBorderColor WorkWithTitle WWPDraggable" style="white-space:nowrap;text-align:start;width:33%" data-colindex="1" draggable="true">
                                                    <span>
                                                        <div class="ColumnSettingsContainer">
                                                            <span>CaseId #</span>
                                                        </div>
                                                    </span>
                                                </th>
                                                <th class="gx-tab-padding-fix-1 WWColumn GridWithPaginationBar GridWithBorderColor WorkWithTitle WWPDraggable" style="white-space: nowrap; text-align: start; width: 33% " data-colindex="2" draggable="true">
                                                    <span>
                                                        <div class="ColumnSettingsContainer">
                                                            <span>Assignee</span>
                                                        </div>
                                                    </span>
                                                </th>
                                                <th class="gx-tab-padding-fix-1 WWColumn GridWithPaginationBar GridWithBorderColor WorkWithTitle WWPDraggable" style="white-space: nowrap; text-align: start; width: 33%" data-colindex="3" draggable="true">
                                                    <span>
                                                        <div class="ColumnSettingsContainer">
                                                            <span>Created At</span>
                                                        </div>
                                                    </span>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                        <tfoot></tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="gx_usercontrol" id="GRIDPAGINATIONBARContainer">
                                    <div id="GRIDPAGINATIONBARContainer_DVPaginationBar" class="PaginationBar" style="display: table; width: 100%;padding:0px;margin:0px;box-shadow:none;">
                                        <div class="PaginationBarButtons" style="float: right;">
                                            <ul class="pagination">
                                                <li class="prev disabled"><a>Prev</a></li>
                                                <li class="next disabled"><a>Next</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 CashDisputeAgingChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="CashDisputeAgingChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="CashDisputeAgingChart"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-12 col-lg-8 CashAggingChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="CashAggingChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="CashAggingChart"></div>
                </div>
            </div>
        </div>
    </div>
</div>
            `
            return DigitalHtml;
        }

        function digitalUI(toggle) {
            let CashHtml = `
            <!--=======================================-->
<!--============= Digital =================-->
<!--=======================================-->
<div class="card" style="overflow:hidden;background-color:transparent;border:none">
    <div class="card-header" id="headingOne">
        <h5 class="mb-0">
            <button type="button" class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" style="border:none;outline:none">
                <div class="divider div-transparent"> <h2>Digital</h2></div>
            </button>
            <div class="wrapper" style="border-bottom: 2px solid var(--colors_materialmenu_selecteditembackground);margin-bottom:10px;">
            </div>
        </h5>
    </div>
    <div id="collapseOne" class="collapse ${toggle}" aria-labelledby="headingOne" data-parent="#Dashboard" style="overflow:hidden">
        <!-- __________ Dashboard Card ______________ -->
        <div class="row" style="margin-top:5px;" id="DigitalTransactionCards">
        </div>
        <!-- __________ Dashboard Circle Card _______________ -->
        <div class="row" id="DigitalAmountCards">
        </div>
        <!-- __________ Chart ____________ -->
        <div class="row" id="progressBarStatistic">
            <div class="chart-containers">
                <div class="loader text-center" id="loader">
                </div>
            </div>

            <div class="col-xs-12 col-md-6 col-lg-4 DigitalOverAllChart1" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DigitalOverAllChartType1">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie" selected>Pie Chart</option>
                        </select>
                    </div>
                    <div id="DigitalOverAllChart1"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 DigitalOverAllChart2" style="margin-top:8px">
                <div style="background-color:white !important;width:100%;height:470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DigitalOverAllChartType2">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DigitalOverAllChart2"></div>
                </div>
            </div>

            <style>
                #DigitalDisputeTable tbody tr:hover {
                    cursor: pointer;
                    background-color: #f0f0f0;
                }
            </style>
            <div class="col-xs-12 col-md-6 col-lg-4 DigitalDisputeChart" style="margin-top: 8px; height:100%;">
                <div class="chart-container" style="height:470px; margin-left:0px;">
                    <h2 style="padding:15px 0px 0px 0px;text-align:center">Disputes</h2>
                    <div id="DigitalDisputeData" class="Table">
                        <div class="row">
                            <div class="col-xs-12 GridParentCell">
                                <div id="GridContainerDiv" data-gxgridid="43" class="gx-grid gx-standard-grid gx-gridGridResizableTitles" style="width: auto;">
                                    <table id="DigitalDisputeTable" class="gx-tab-spacing-fix-2 GridWithPaginationBar GridWithBorderColor WorkWith table-responsive" data-cellpadding="1" data-cellspacing="2">
                                        <thead>
                                            <tr>
                                                <th class="gx-tab-padding-fix-1 WWColumn GridWithPaginationBar GridWithBorderColor WorkWithTitle WWPDraggable" style="white-space:nowrap;text-align:start;width:33%" data-colindex="1" draggable="true">
                                                    <span>
                                                        <div class="ColumnSettingsContainer">
                                                            <span>CaseId #</span>
                                                        </div>
                                                    </span>
                                                </th>
                                                <th class="gx-tab-padding-fix-1 WWColumn GridWithPaginationBar GridWithBorderColor WorkWithTitle WWPDraggable" style="white-space: nowrap; text-align: start; width: 33% " data-colindex="2" draggable="true">
                                                    <span>
                                                        <div class="ColumnSettingsContainer">
                                                            <span>Assignee</span>
                                                        </div>
                                                    </span>
                                                </th>
                                                <th class="gx-tab-padding-fix-1 WWColumn GridWithPaginationBar GridWithBorderColor WorkWithTitle WWPDraggable" style="white-space: nowrap; text-align: start; width: 33%" data-colindex="3" draggable="true">
                                                    <span>
                                                        <div class="ColumnSettingsContainer">
                                                            <span>Created At</span>
                                                        </div>
                                                    </span>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                        <tfoot></tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="gx_usercontrol" id="GRIDPAGINATIONBARContainer">
                                    <div id="GRIDPAGINATIONBARContainer_DVPaginationBar" class="PaginationBar" style="display: table; width: 100%;padding:0px;margin:0px;box-shadow:none;">
                                        <div class="PaginationBarButtons" style="float: right;">
                                            <ul class="pagination">
                                                <li class="prev disabled"><a>Prev</a></li>
                                                <li class="next disabled"><a>Next</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 DigitalDisputeAgingChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DigitalDisputeAgingChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DigitalDisputeAgingChart"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-12 col-lg-8 DigitalAggingChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DigitalAggingChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DigitalAggingChart"></div>
                </div>
            </div>
        </div>

    </div>
</div>`;
            return CashHtml;
        }

        function TransformerUI(toggle) { //hidde
            let TransformerHtml = `
            <!--=======================================-->
<!--============== Transformer ===================-->
<!--=======================================-->
<div class="card" style="overflow:hidden;background-color:transparent;border:none">
    <div class="card-header" id="headingTwo">
        <h5 class="mb-0">
            <button type="button" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTransformer" aria-expanded="false" aria-controls="collapseTransformer" style="border:none;outline:none">
                <div class="divider div-transparent"> <h2>Transformer</h2></div>
            </button>
            <div class="wrapper" style="border-bottom: 2px solid var(--colors_materialmenu_selecteditembackground);margin-bottom:10px;overflow:hidden">
            </div>
        </h5>
    </div>
    <div id="collapseTransformer" class="collapse ${toggle}" aria-labelledby="headingTwo" data-parent="#Dashboard" style="overflow:hidden">
        <!-- __________ Dashboard Card ______________ -->
        <div class="row" style="margin-top:5px;" id="TransformerTransactionCards">
        </div>
        <!-- __________ Dashboard Circle Card _______________ -->
        <div class="row" id="TransformerAmountCards">
        </div>
        <!-- __________ Chart ____________ -->
        <div class="row" id="progressBarStatistic">
            <div class="chart-containers">
                <div class="loader text-center" id="loader">
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 EltDataLoadingFileChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="TransformerOverAllChartType4">
                            <option value="column" >Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar" selected>Bar Chart</option>
                            
                        </select>
                    </div>
                    <div id="EltDataLoadingFileChart"></div>
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 DBChartLoad" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DBChartLoadType">
                            <option value="column" selected>Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DBChartLoad"></div>
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 APIUploadChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="APIUploadChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area" >Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar" selected>Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="APIUploadChart"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 TransformerOverAllDestCount" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="TransformerOverAllChartType3">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie" selected>Pie Chart</option>
                        </select>
                    </div>
                    <div id="TransformerOverAllDestCount"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-8 TransformerOverAllSourceCount" style="margin-top:8px">
                <div style="background-color:white !important;width:100%;height:470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="TransformerOverAllChartType2">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="TransformerOverAllSourceCount"></div>
                   
                </div>
            </div>
           
           
        </div>
    </div>
</div>
            `
            return TransformerHtml
        }

        function SettlementUI(toggle) { //hidde
            let SettlementHtml = `
            <!--=======================================-->
<!--============== Settlement ===================-->
<!--=======================================-->
<div class="card" style="overflow:hidden;background-color:transparent;border:none">
    <div class="card-header" id="headingTwo">
        <h5 class="mb-0">
            <button type="button" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseSettlement" aria-expanded="false" aria-controls="collapseSettlement" style="border:none;outline:none">
                <div class="divider div-transparent"> <h2>Settlement</h2></div>
            </button>
            <div class="wrapper" style="border-bottom: 2px solid var(--colors_materialmenu_selecteditembackground);margin-bottom:10px;overflow:hidden">
            </div>
        </h5>
    </div>
    <div id="collapseSettlement" class="collapse ${toggle}" aria-labelledby="headingTwo" data-parent="#Dashboard" style="overflow:hidden">
        <!-- __________ Dashboard Card ______________ -->
        <div class="row" style="margin-top:5px;" id="SettlementTransactionCards">
        </div>
        <!-- __________ Dashboard Circle Card _______________ -->
        <div class="row" id="SettlementAmountCards">
        </div>
        <!-- __________ Chart ____________ -->
        <div class="row" id="progressBarStatistic">
            <div class="chart-containers">
                <div class="loader text-center" id="loader">
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 EltDataLoadingFileChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="SettlementOverAllChartType4">
                            <option value="column" >Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar" selected>Bar Chart</option>
                            
                        </select>
                    </div>
                    <div id="EltDataLoadingFileChart"></div>
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 DBChartLoad" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DBChartLoadType">
                            <option value="column" selected>Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DBChartLoad"></div>
                </div>
            </div>
            <!-- <div class="col-xs-12 col-md-6 col-lg-4 APIUploadChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="APIUploadChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area" >Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar" selected>Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="APIUploadChart"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 SettlementOverAllDestCount" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="SettlementOverAllChartType3">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie" selected>Pie Chart</option>
                        </select>
                    </div>
                    <div id="SettlementOverAllDestCount"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-8 SettlementOverAllSourceCount" style="margin-top:8px">
                <div style="background-color:white !important;width:100%;height:470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="SettlementOverAllChartType2">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="SettlementOverAllSourceCount"></div>
                   
                </div>
            </div>-->
           
           
        </div>
    </div>
</div>
            `
            return SettlementHtml
        }

        function DisputeUI(toggle) { //hidde
            let DisputeHtml = `
            <!--=======================================-->
<!--============== Dispute ===================-->
<!--=======================================-->
<div class="card" style="overflow:hidden;background-color:transparent;border:none">
    <div class="card-header" id="headingTwo">
        <h5 class="mb-0">
            <button type="button" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseDispute" aria-expanded="false" aria-controls="collapseDispute" style="border:none;outline:none">
                <div class="divider div-transparent"> <h2>Dispute</h2></div>
            </button>
            <div class="wrapper" style="border-bottom: 2px solid var(--colors_materialmenu_selecteditembackground);margin-bottom:10px;overflow:hidden">
            </div>
        </h5>
    </div>
    <div id="collapseDispute" class="collapse ${toggle}" aria-labelledby="headingTwo" data-parent="#Dashboard" style="overflow:hidden">
        <!-- __________ Dashboard Card ______________ -->
        <div class="row" style="margin-top:5px;" id="DisputeTransactionCards">
        </div>
        <!-- __________ Dashboard Circle Card _______________ -->
        <div class="row" id="DisputeAmountCards">
        </div>
        <!-- __________ Chart ____________ -->
        <div class="row" id="progressBarStatistic">
            <div class="chart-containers">
                <div class="loader text-center" id="loader">
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 EltDataLoadingFileChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DisputeOverAllChartType4">
                            <option value="column" >Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar" selected>Bar Chart</option>
                            
                        </select>
                    </div>
                    <div id="EltDataLoadingFileChart"></div>
                </div>
            </div>
             <div class="col-xs-12 col-md-6 col-lg-4 DBChartLoad" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DBChartLoadType">
                            <option value="column" selected>Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DBChartLoad"></div>
                </div>
            </div>
            <!-- <div class="col-xs-12 col-md-6 col-lg-4 APIUploadChart" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="APIUploadChartType">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area" >Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar" selected>Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="APIUploadChart"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-4 DisputeOverAllDestCount" style="margin-top:8px">
                <div style="background-color: white !important; width: 100%; height: 470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DisputeOverAllChartType3">
                            <option value="column">Column Chart</option>
                            <option value="line" selec>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie" selected>Pie Chart</option>
                        </select>
                    </div>
                    <div id="DisputeOverAllDestCount"></div>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 col-lg-8 DisputeOverAllSourceCount" style="margin-top:8px">
                <div style="background-color:white !important;width:100%;height:470px" class="chart-container">
                    <div class="chart-dropdown" style="text-align:center;margin-top:10px; margin-bottom:10px;margin-right:15px">
                        <select id="DisputeOverAllChartType2">
                            <option value="column">Column Chart</option>
                            <option value="line" selected>Line Chart</option>
                            <option value="area">Area Chart</option>
                            <option value="spline">Spline Chart</option>
                            <option value="bar">Bar Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                    </div>
                    <div id="DisputeOverAllSourceCount"></div>
                   
                </div>
            </div>-->
           
           
        </div>
    </div>
</div>
            `
            return DisputeHtml
        }

    }
    RoleLicensceBaseUI();

    //___________ Refresh Logic ___________
    const refreshData = async (isPageLoad = false) => {
        try {
            const { CurrentRole, LicenseModules } = RoleBaseModuleGloble;
            RoleName = CurrentRole;

            const hasTransformerModule = LicenseModules.some(l => l.AppModuleName === "Transformer");
            const hasDigitalModule = LicenseModules.some(l => l.AppModuleName === "Digital");
            const hasCashModule = LicenseModules.some(l => l.AppModuleName === "Cash");
            const hasSettlementModule = LicenseModules.some(l => l.AppModuleName === "Settlement");
            const hasDisputeModule = LicenseModules.some(l => l.AppModuleName === "Dispute");

            handleModuleRefresh(
                hasDigitalModule,
                hasCashModule,
                hasTransformerModule,
                hasSettlementModule,
                hasDisputeModule,
                isPageLoad
            );
        } catch (error) {
            console.error('Error during data refresh:', error);
        }
    };

    //___________ Refresh Button Handler ___________
    const handleModuleRefresh = (
        hasDigitalModule,
        hasCashModule,
        hasTransformerModule,
        hasSettlementModule,
        hasDisputeModule,
        isPageLoad
    ) => {
        if (
            !hasDigitalModule &&
            !hasCashModule &&
            hasTransformerModule &&
            !hasSettlementModule &&
            !hasDisputeModule
        ) {
            RefreshModule("Transformer", isPageLoad);
        } else if (
            !hasDigitalModule &&
            !hasCashModule &&
            !hasTransformerModule &&
            hasSettlementModule &&
            !hasDisputeModule
        ) {
            RefreshModule("Settlement", isPageLoad);
        } else if (
            !hasDigitalModule &&
            !hasCashModule &&
            !hasTransformerModule &&
            !hasSettlementModule &&
            hasDisputeModule
        ) {
            RefreshModule("Dispute", isPageLoad);
        } else if (
            !hasDigitalModule &&
            hasCashModule &&
            !hasTransformerModule &&
            !hasSettlementModule &&
            !hasDisputeModule
        ) {
            RefreshModule("Cash", isPageLoad);
        } else if (
            hasDigitalModule &&
            !hasCashModule &&
            !hasTransformerModule &&
            !hasSettlementModule &&
            !hasDisputeModule
        ) {
            RefreshModule("Digital", isPageLoad);
        } else if (
            hasDigitalModule &&
            hasCashModule &&
            hasTransformerModule &&
            hasSettlementModule &&
            hasDisputeModule
        ) {
            switch (RoleName) {
                case "Admin":
                    RefreshModule("Digital,Cash,Transformer,Settlement,Dispute", isPageLoad);
                    break;
                case "Digital Admin":
                case "Digital User":
                    RefreshModule("Digital", isPageLoad);
                    break;
                case "Cash Admin":
                    RefreshModule("Cash", isPageLoad);
                    break;
                case "Transformer Admin":
                    RefreshModule("Transformer", isPageLoad);
                    break;
                case "Settlement Admin":
                case "Settlement User":
                    RefreshModule("Settlement", isPageLoad);
                    break;
                case "Dispute Admin":
                case "Dispute User":
                    RefreshModule("Dispute", isPageLoad);
                    break;
                default:
                    console.warn(`Unhandled RoleName: ${RoleName}`);
            }
        } else {
            console.warn('Unhandled module combination:', {
                hasDigitalModule,
                hasCashModule,
                hasTransformerModule,
                hasSettlementModule,
                hasDisputeModule,
            });
        }
    };

    //___________ DOM Content Loaded Handler ___________
    document.addEventListener('DOMContentLoaded', () => {
        const refreshButton = document.querySelector('.refreshBtn');

        if (refreshButton) {
            // Add click event listener to the refresh button
            refreshButton.addEventListener('click', () => {
                refreshData(true);
            });
        } else {
            console.warn('Refresh button with class .refreshBtn not found.');
        }

        // // Start the automatic refresh timer
        // const refreshInterval = 2000;
        // setInterval(() => {
        //     refreshData(false);
        // }, refreshInterval);
    });

</script>


<!--_________________________________________________________-->
<!--__________________ UI_Module Functionality ______________-->
<!--_________________________________________________________-->
<script>
    function LoadAlert() {
        async function fetchTransactionBandAlert() {
            try {
                const response = await fetch('rest/wsGetTransactionBandAlert', {
                    method: 'POST',
                    headers: {
                        "Content-type": "application/json; charset=UTF-8",
                        'Authorization': token
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const apiResponse = await response.json();
                let data = apiResponse.SDT_LicenseTrnLimitResponses;

                // Filter data to include only items with non-empty LicenseTrnLimitType and LicenseTrnLimitMessage
                const filteredData = data.filter(item =>
                    item.LicenseTrnLimitType.trim() !== "" &&
                    item.LicenseTrnLimitMessage.trim() !== ""
                );

                const parentAlertDiv = document.getElementById('ParentAlert');
                parentAlertDiv.innerHTML = '';

                // Map the LicenseTrnLimitColor values to actual colors
                const colorMap = {
                    "softwarningcolor": "#fff3cd", // Light yellow for soft warnings
                    "Green": "#d4edda",            // Light green for digital soft warnings
                    "Red": "#f8d7da",              // Light red for warnings
                    "Danger": "#f5c6cb"            // Updated deeper red/pink for danger
                };

                // Map LicenseTrnLimitStatus to icons
                const iconMap = {
                    "SoftWarning": "fa fa-exclamation-circle mr-2",
                    "Warning": "fa fa-warning mr-2",
                    "Danger": "fa fa-ban mr-2"
                };

                filteredData.forEach(item => {
                    const backgroundColor = colorMap[item.LicenseTrnLimitColor] || '#f8d7da';
                    const iconClass = iconMap[item.LicenseTrnLimitStatus] || 'fa fa-info-circle mr-2'; // Default icon

                    // Create a badge for the module name
                    const badgeHtml = `
                        <span class="badge" 
                            style="background-color: ${getBadgeColor(item.LicenseTrnLimitColor)}; 
                                    color: #fff; 
                                    font-weight: bold; 
                                    margin-right: 12px;">
                            ${item.LicenseTrnLimitType}
                        </span>
                    `;

                    // Create alert HTML with dynamic color, icon, and bold message
                    const alertHtml = `
                        <div class="alert" 
                            style="
                                background-color: ${backgroundColor}; 
                                color: #721c24; 
                                margin: 7px 0; 
                                padding: 10px; 
                                border-radius: 4px; 
                                ">
                            ${badgeHtml}
                            <i class="${iconClass}"></i>
                            ${item.LicenseTrnLimitMessage}
                        </div>
                    `;

                    parentAlertDiv.innerHTML += alertHtml;
                });

            } catch (error) {
                console.error('Internal Error fetching data:', error);
            }
        }

        // Helper function to determine badge color based on LicenseTrnLimitColor
        function getBadgeColor(colorKey) {
            const badgeColorMap = {
                "softwarningcolor": "#856404", // Dark yellow
                "Green": "#155724",            // Dark green
                "Red": "#721c24",              // Dark red
                "Danger": "#721c24"            // Dark red for danger
            };
            return badgeColorMap[colorKey] || "#856404"; // Default to dark yellow
        }

        fetchTransactionBandAlert();
    }

    // Uncomment this block to show a customer alert
    // window.onload = function () {
    //     const alertDiv = document.getElementById('customerAlert');
    //
    //     alertDiv.style.display = 'block';
    //
    //     // Hide the alert after 2 seconds
    //     setTimeout(() => {
    //         alertDiv.classList.add('hidden');
    //
    //         // Completely remove it from view after the fade-out animation
    //         setTimeout(() => {
    //             alertDiv.style.display = 'none';
    //         }, 500); // Match the CSS transition duration
    //     }, 4000);
    // };

    //________________________________________
    //____________ Digital ___________________
    //________________________________________
    function Digital() {
        //_______________________________________
        //______________ Commons ________________
        //_______________________________________
        hideDigitlCharts();
        function hideDigitlCharts() {
            $(".DigitalOverAllChart1").hide();
            $(".DigitalOverAllChart2").hide();
            $(".DigitalAggingChart").hide();
            $(".DigitalDisputeChart").hide();
            $(".DigitalDisputeAgingChart").hide();
        }
        function showDigitalChartHideLoader() {
            $(".chart-containers").hide();
            $(".DigitalDisputeChart").show();
            $(".DigitalAggingChart").show();
            $(".DigitalOverAllChart1").show();
            $(".DigitalOverAllChart2").show();
            $(".DigitalDisputeAgingChart").show();
        }

        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().split('T')[0];
        //const formattedDate = "2024-08-22"

        const lastWeekDate = new Date(currentDate);
        lastWeekDate.setDate(currentDate.getDate() - 7);
        const formattedDateLastWeek = lastWeekDate.toISOString().split('T')[0];

        //_______________________________________
        //____________ Dispute Table ____________
        //_______________________________________
        function DigitalDisputeTable() {
            async function LoadDigitalDesputesData() {
                try {
                    let obj = {
                        "apiType": "Digital"
                    }
                    const response = await fetch('rest/prDisputesAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const apiResponse = await response.json();
                    return apiResponse.SDT_wpInvestigation || [];
                } catch (error) {
                    showDigitalChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }

            let currentPageDigital = 1;
            const recordsPerPageDigital = 8;
            let disputesDataDigital = [];

            async function LoadDesputesGridDigital() {
                disputesDataDigital = await LoadDigitalDesputesData();
                renderTableDigital(currentPageDigital);
                setupPaginationDigital();
            }
            function renderTableDigital(page) {
                const startIndex = (page - 1) * recordsPerPageDigital;
                const endIndex = startIndex + recordsPerPageDigital;
                const paginatedData = disputesDataDigital.slice(startIndex, endIndex);

                const tableBody = document.querySelector('#DigitalDisputeTable tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                paginatedData.forEach(item => {
                    const row = `
                                    <tr class="GridWithPaginationBar GridWithBorderColor WorkWithOdd" data-investigation-case-id="${item.InvestigationCaseId}">
                                        <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                            <p class="form-control-static"><span class="Attribute">${item.InvestigationCaseId}</span></p>
                                        </td>
                                        <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                            <p class="form-control-static"><span class="Attribute">${item.InvestigationAssigneeUserName}</span></p>
                                        </td>
                                        <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                            <p class="form-control-static"><span class="Attribute">${item.CreationDate}</span></p>
                                        </td>
                                    </tr>
                                `;
                    tableBody.insertAdjacentHTML('beforeend', row);
                });

                attachRowClickEventDigital()
            }
            function attachRowClickEventDigital() {
                $('#DigitalDisputeTable tbody').on('click', 'tr', function () {
                    const investigationCaseId = $(this).data('investigation-case-id');
                    if (investigationCaseId) {
                        const url = `wpinvestigationcase.aspx?InvestigationCaseId=${investigationCaseId}`;
                        window.location.href = url;
                    }
                });
            }
            function setupPaginationDigital() {
                const totalPages = Math.ceil(disputesDataDigital.length / recordsPerPageDigital);
                const paginationBar = document.querySelector('.pagination');

                paginationBar.innerHTML = ''; // Clear existing pagination

                paginationBar.innerHTML += `<li class="prev ${currentPageDigital === 1 ? 'disabled' : ''}"><a href="#">Prev</a></li>`;

                for (let i = 1; i <= totalPages; i++) {
                    paginationBar.innerHTML += `<li class="${i === currentPageDigital ? 'active' : ''}"><a href="#">${i}</a></li>`;
                }

                paginationBar.innerHTML += `<li class="next ${currentPageDigital === totalPages ? 'disabled' : ''}"><a href="#">Next</a></li>`;
                setupPaginationEventsDigital();
            }
            function setupPaginationEventsDigital() {
                const paginationBar = document.querySelector('.pagination');

                paginationBar.addEventListener('click', function (e) {
                    e.preventDefault();

                    if (e.target.tagName === 'A') {
                        if (e.target.parentElement.classList.contains('prev') && currentPageDigital > 1) {
                            currentPageDigital--;
                        } else if (e.target.parentElement.classList.contains('next') && currentPageDigital < Math.ceil(disputesDataDigital.length / recordsPerPageDigital)) {
                            currentPageDigital++;
                        } else if (!e.target.parentElement.classList.contains('prev') && !e.target.parentElement.classList.contains('next')) {
                            currentPageDigital = parseInt(e.target.textContent, 10);
                        }
                        renderTable(currentPageDigital);
                        setupPagination();
                    }
                });
            }

            document.addEventListener('DOMContentLoaded', LoadDesputesGridDigital);
        }
        DigitalDisputeTable();

        //_______________________________________
        //______________________ Cards __________
        //_______________________________________
        function LoadCardsDigital() {
            function LoadHeaderCardUIDigital() {

                var headerCartDigital = `

            <div class="col-xl-3 col-lg-6 col-sm-6">
                <div class="card card-stats card_1 mb-4 mb-xl-0" style="height: 73px;">



                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL</h5>
                                <span class="h2 font-weight-bold mb-0" id="totalTxtDigital" style="color:black !important">0</span>
                            </div>
                            <div class="col-auto">
                                <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#177a9a;">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                            </div>
                        </div>
                        <!--<p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                            <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercDigital" style="color: #177a9a">0%</b></span>
                            <span class="text-nowrap" style="color:black">Total Transaction</span>
                        </p>-->
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-6  col-sm-6">
                <div class="card card-stats card_5-match mb-4 mb-xl-0" style="height: 73px;">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">MATCHED</h5>
                                <span class="h2 font-weight-bold mb-0" style="color:black !important" id="matchTxtDigital">0</span>
                            </div>
                            <div class="col-auto">
                                <div class="icon icon-shape-matched  text-white rounded-circle shadow">
                                    <i class="fas fa-chart-pie" style="font-size:1.25rem;"></i>
                                </div>
                            </div>
                        </div>
                        <!--<p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                            <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="matchPercDigital" style="color: #fe8612 ">0%</b></span>
                            <span class="text-nowrap" style="color:black !important">Matched Transaction</span>
                        </p>-->
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-6 col-sm-6">
                <div class="card card-stats card_6-proposed mb-xl-0" style="height: 73px;">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">PROPOSED</h5>
                                <span class="h2 font-weight-bold mb-0" id="proposedTxtDigital" style="color:black !important">0</span>
                            </div>
                            <div class="col-auto">
                                <div class="icon  icon-shape-proposed  text-white rounded-circle shadow">
                                    <i class="fas fa-cubes"  style="font-size:1.25rem;"></i>
                                </div>
                            </div>
                        </div>
                        <!--<p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                            <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="proposedPercDigital"> 0%</b></span>
                            <span class="text-nowrap" style="color:black !important">Proposed Transaction</span>
                        </p>-->
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-6 col-sm-6">
                <div class="card card-stats card_7-unMatched mb-4 mb-xl-0" style="height: 73px;">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">UNMATCHED</h5>
                                <span class="h2 font-weight-bold mb-0" style="color:black !important" id="unMatchedTxtDigital">0</span>

                            </div>
                            <div class="col-auto">
                                <div class="icon icon-shape-unmatched  text-white rounded-circle shadow">
                                    <i class="fas fa-percent"  style="font-size:1.25rem;"></i>
                                </div>
                            </div>
                        </div>
                        <!--<p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                            <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="unMatchedPercDigital" style="color: #76407a">0%</b></span>
                            <span class="text-nowrap" style="color:black !important">Unmatch Transaction</span>
                        </p>-->
                    </div>
                </div>
            </div>
            `;
                $("#DigitalTransactionCards").html(headerCartDigital);

                var headerCartCircleAmountDigital = `<div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
            <div class="chart-containerCircel" style="height:73px;background-color: #177a9a24; border: 2px solid #177a9a; box-shadow: 2px 2px 5px #00000063;">
                <div class="chart-info-wrapper">
                    <h2>Total</h2>
                    <span class="totalAmountTxtDigital">Rs 0</span>
                </div>
                <div class="chart-svg " style="margin-top:15px">
                    <svg viewBox="0 0 42 42" class="circular-chart systemColor">
                        <path class="circle-bg" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <path class="circle totalCircle" stroke-dasharray="0, 100" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <text x="18" y="20.35" class="percentage totalPercDigital">0%</text>
                    </svg>
                </div>
            </div>
        </div>
        <div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
            <div class="chart-containerCircel  chart-containerCircel-matched" style="background-color: #cfe6de" >
                <div class="chart-info-wrapper">
                    <h2>Matched</h2>
                    <span class="matchAmountTxtDigital">Rs 0</span>
                </div>
                <div class="chart-svg" style="margin-top:15px">
                    <svg viewBox="0 0 42 42" class="circular-chart blue circle-matched">
                        <path class="circle-bg" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <path class="circle matchCircle" style="stroke:#058a22" stroke-dasharray="0, 100" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <text x="18" y="20.35" class="percentage matchPercDigital">0%</text>
                    </svg>
                </div>
            </div>
        </div>
        <div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
            <div class="chart-containerCircel chart-containerCircel-proposed" style="background-color: #f1c0932b;">
                <div class="chart-info-wrapper">
                    <h2>Proposed</h2>
                    <span class="proposedAmountTxtDigital">Rs 0</span>
                </div>
                <div class="chart-svg" style="margin-top:15px">
                    <svg viewBox="0 0 42 42" class="circular-chart orange">
                        <path class="circle-bg" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <path class="circle proposedCircle" style="stroke:#fe8612;" stroke-dasharray="0, 100" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <text x="18" y="20.35" class="percentage proposedPercDigital">0%</text>
                    </svg>
                </div>
            </div>
        </div>
        <div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
            <div class="chart-containerCircel  chart-containerCircel-unmatched" style=" background-color: #b70e0e29;">
                <div class="chart-info-wrapper">
                    <h2>Unmatched</h2>
                    <span class="unMatchedAmountTxtDigital">Rs 0</span>
                </div>
                <div class="chart-svg" style="margin-top:15px">
                    <svg viewBox="0 0 42 42" class="circular-chart darklight">
                        <path class="circle-bg" d="M18 2.0845
            a 15.9155 15.9155 0 0 1 0 31.831
            a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <path class="circle" style="stroke:#bd1c1c !important;" stroke-dasharray="0, 100" d="M18 2.0845
            a 15.9155 15.9155 0 0 1 0 31.831
            a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                        <text x="18" y="20.35" class="percentage unMatchedPercDigital">0%</text>
                    </svg>
                </div>
            </div>
        </div>`;
                $("#DigitalAmountCards").html(headerCartCircleAmountDigital);
            }
            LoadHeaderCardUIDigital()
            async function SetDigitalCardsData() {
                try {
                    let obj = {
                        "dateTime": formattedDate,//"2024-07-29",
                        "ApiType": "Digital"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, TotalStatistics } = apiResponse.SDT_ChartData;
                    const [objec] = TotalStatistics;

                    //_______ Total and Amount _____
                    const { Match, Unmatch, Proposed, Total, MatchAmount, UnmatchAmount, ProposedAmount, TotalAmount } = objec;
                    if (TotalStatistics.length > 0) {
                        $("#totalTxtDigital").text(Total);
                        $("#matchTxtDigital").text(Match);
                        $("#proposedTxtDigital").text(Proposed);
                        $("#unMatchedTxtDigital").text(Unmatch);

                        $(".totalAmountTxtDigital").text(formatCurrency(TotalAmount));
                        $(".matchAmountTxtDigital").text(formatCurrency(MatchAmount));
                        $(".proposedAmountTxtDigital").text(formatCurrency(ProposedAmount));
                        $(".unMatchedAmountTxtDigital").text(formatCurrency(UnmatchAmount));

                    }

                    if (Total > 0) {
                        // Percentage
                        matchedPer = ((parseFloat(Match) / parseFloat(Total)) * 100).toFixed(1) + '%';
                        proposedPer = ((parseFloat(Proposed) / parseFloat(Total)) * 100).toFixed(1) + '%';
                        unmatchedPer = ((parseFloat(Unmatch) / parseFloat(Total)) * 100).toFixed(1) + '%';
                        $(".unMatchedPercDigital").text(unmatchedPer);
                        $(".proposedPercDigital").text(proposedPer);
                        $(".matchPercDigital").text(matchedPer);
                        $(".totalPercDigital").text("100%");

                        //circle
                        $(".circle.totalCircle").attr("stroke-dasharray", (parseFloat(100) + ", 100"));
                        $(".circle.matchCircle").attr("stroke-dasharray", (parseFloat(matchedPer) + ", 100"));
                        $(".circle.proposedCircle").attr("stroke-dasharray", (parseFloat(proposedPer) + ", 100"));
                        $(".circle.unmatchedCircle").attr("stroke-dasharray", (parseFloat(unmatchedPer) + ", 100"));

                        //Progress
                        $(".progress_number_digital_total").text('100%');
                        $(".progress_number_digital_matched").text(matchedPer);
                        $(".progress_number_digital_proposed").text(proposedPer);
                        $(".progress_number_digital_unmatched").text(unmatchedPer);

                        $(".progress-bar-inner-total-digital").css("width", '100%');
                        $(".progress-bar-inner-matched-digital").css("width", matchedPer);
                        $(".progress-bar-inner-proposed-digital").css("width", proposedPer);
                        $(".progress-bar-inner-unmatched-digital").css("width", unmatchedPer);
                    }

                } catch (error) {
                    console.error('Error fetching data:', error);
                }
            }
            SetDigitalCardsData();
            function formatCurrency(amount) {
                const formatter = new Intl.NumberFormat('en-PK', {
                    style: 'currency',
                    currency: 'PKR',
                });
                return formatter.format(amount);
            }
        }
        LoadCardsDigital()

        //_______________________________________
        //______________________ Chart __________
        //_______________________________________
        function Digitalchart() {
            document.getElementById('DigitalOverAllChartType1').addEventListener('change', function () {
                updateChart('DigitalOverAllChart1', this.value);
            });
            document.getElementById('DigitalOverAllChartType2').addEventListener('change', function () {
                updateChart('DigitalOverAllChart2', this.value);
            });
            document.getElementById('DigitalAggingChartType').addEventListener('change', function () {
                updateChart('DigitalAggingChart', this.value);
            });
            document.getElementById('DigitalDisputeAgingChartType').addEventListener('change', function () {
                updateChart('DigitalDisputeAgingChart', this.value);
            });

            function updateChart(chartId, chartType) {
                if (chartId == "DigitalOverAllChart1") {
                    DigitalOverAllChart1(chartId, chartType, "Transaction Amount", formattedDate);
                }
                else if (chartId == "DigitalOverAllChart2") {
                    DigitalOverAllChart2(chartId, chartType);
                }
                else if (chartId == "DigitalAggingChart") {
                    DigitalAggingChart(chartId, chartType, 'Amount Aging');
                }
                else if (chartId == "DigitalDisputeAgingChart") {
                    DigitalDisputeAgingChart(chartId, chartType, "Dispute Aging", "");
                }
            }

            //----------------------------
            //---- Over All Chart 1 ------
            //----------------------------
            async function fetchDigitalChartDataOverAll(date) {
                try {
                    let obj = {
                        "dateTime": date,
                        "ApiType": "Digital"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3 } = apiResponse.SDT_ChartData || {};

                    const colors = ['#7cb5ec', '#434348', '#90ed7d', '#f7a35c', '#8085e9', '#f15c80', '#e4d354', '#8d4654', '#91e8e1'];

                    const series = Array.isArray(Data) ? [{
                        name: 'Transaction Amount',
                        colorByPoint: true,
                        data: Data.map((parent, index) => ({
                            name: parent.TrLifeCycleName,
                            y: parseFloat(parent.TotalAmount),
                            drilldown: parent.UniqueKey, // Ensure this matches the id in drilldownSeries
                            color: colors[index % colors.length]
                        }))
                    }] : [];

                    const drilldownSeries = Array.isArray(Level1) ? Level1.map(item => ({
                        name: item.AccName,
                        id: item.UniqueKey,
                        data: Level1
                            .filter(l2 => l2.UniqueKey.startsWith(item.UniqueKey))
                            .map(l2 => [l2.AccName, parseFloat(l2.TotalAmount)])
                    })) : [];

                    if (Array.isArray(Level2) && Array.isArray(Level3)) {
                        Level2.forEach(item => {
                            drilldownSeries.push({
                                name: item.MatchStatus,
                                id: item.UniqueKey,
                                data: Level3
                                    .filter(l3 => l3.UniqueKey.startsWith(item.UniqueKey))
                                    .map(l3 => [l3.MatchStatus, parseFloat(l3.Amount)])
                            });
                        });
                    }

                    return {
                        series: series,
                        drilldown: {
                            series: drilldownSeries
                        }
                    };
                } catch (error) {
                    showDigitalChartHideLoader();
                    console.log('Error fetching data: ' + error.message);
                }
            }
            async function DigitalOverAllChart1(containerId, chartType, title, date) {
                try {
                    const data = await fetchDigitalChartDataOverAll(date);
                    let chartOptions;

                    if (data && data.series && data.series.length > 0) {
                        // **Data Exists:** Configure the chart with the fetched data
                        chartOptions = {
                            colors: ['#7cb5ec', '#434348', '#90ed7d', '#f7a35c', '#8085e9', '#f15c80', '#e4d354', '#8d4654', '#91e8e1'],
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    drilldown: function (e) {
                                        this.setTitle({ text: e.point.name });
                                    },
                                    drillup: function () {
                                        this.setTitle({ text: title });
                                    }
                                }
                            },
                            title: {
                                text: title,
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    style: {
                                        color: '#2b908f'
                                    }
                                }
                            },
                            yAxis: {
                                title: {
                                    text: 'Values',
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)'
                                    },
                                    formatter: function () {
                                        return this.value === 0 ? '' : this.value;
                                    }
                                }
                            },
                            legend: {
                                enabled: false // Disable the legend to remove the series names and logos
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '{point.name}: {point.y:.2f} ({point.percentage:.2f}%)',
                                        style: {
                                            color: '#000000'
                                        }
                                    },
                                    showInLegend: true
                                }
                            },
                            series: data.series,
                            drilldown: {
                                series: data.drilldown?.series || [],
                                drillUpButton: {
                                    relativeTo: 'spacingBox',
                                    position: {
                                        y: 0,
                                        x: 0
                                    },
                                    theme: {
                                        fill: 'white',
                                        'stroke-width': 1,
                                        stroke: 'silver',
                                        r: 0
                                    }
                                }
                            },
                            tooltip: {
                                formatter: function () {
                                    if (this.point.drilldown) {
                                        return `<b>${this.point.name}</b><br/>Total Amount: ${Highcharts.numberFormat(this.y, 2)} (${Highcharts.numberFormat(this.percentage, 2)}%)`;
                                    } else {
                                        return `<b>${this.point.name}</b><br/>${Highcharts.numberFormat(this.y, 2)} (${Highcharts.numberFormat(this.percentage, 2)}%)`;
                                    }
                                }
                            }
                        };
                    } else {
                        // **No Data:** Configure an empty chart with the specified title
                        chartOptions = {
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)'
                            },
                            title: {
                                text: title, // Keep the original title "Transaction Amount"
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    enabled: false // Hide labels since there's no data
                                },
                                visible: false // Hide the X-axis entirely
                            },
                            yAxis: {
                                title: {
                                    text: 'Values',
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    enabled: false // Hide labels since there's no data
                                },
                                visible: false // Hide the Y-axis entirely
                            },
                            legend: {
                                enabled: false // Disable the legend
                            },
                            series: [{
                                name: 'No Data',
                                data: [], // Empty data
                                dataLabels: {
                                    enabled: false // Disable data labels
                                }
                            }],
                            plotOptions: {
                                pie: {
                                    dataLabels: {
                                        enabled: false // Disable data labels for pie chart
                                    }
                                }
                            },
                            tooltip: {
                                enabled: false // Disable tooltips since there's no data
                            }
                        };
                    }

                    // **Render the Chart:** Always call Highcharts.chart with the configured options
                    Highcharts.chart(containerId, chartOptions);
                } catch (error) {
                    console.error('Error fetching or rendering chart data:', error);

                    // **Optional:** Render an empty chart with the title if an error occurs
                    const emptyChartOptions = {
                        chart: {
                            type: chartType,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)'
                        },
                        title: {
                            text: title, // "Transaction Amount"
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '20px'
                            }
                        },
                        xAxis: {
                            type: 'category',
                            labels: {
                                enabled: false
                            },
                            visible: false
                        },
                        yAxis: {
                            title: {
                                text: 'Values',
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '16px'
                                }
                            },
                            labels: {
                                enabled: false
                            },
                            visible: false
                        },
                        legend: {
                            enabled: false
                        },
                        series: [{
                            name: 'No Data',
                            data: [],
                            dataLabels: {
                                enabled: false
                            }
                        }],
                        plotOptions: {
                            pie: {
                                dataLabels: {
                                    enabled: false
                                }
                            }
                        },
                        tooltip: {
                            enabled: false
                        }
                    };

                    Highcharts.chart(containerId, emptyChartOptions);
                }
            }
            DigitalOverAllChart1("DigitalOverAllChart1", "pie", "Transaction Amount", formattedDate);



            //----------------------------
            //---- Over All Chart 2 ------
            //----------------------------
            async function fetchDigitalChartDataOverAll1() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Digital"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, TotalStatistics } = apiResponse.SDT_ChartData;
                    const [objec] = TotalStatistics;
                    const { Match, Unmatch, Proposed, Total, MatchAmount, UnmatchAmount, ProposedAmount, TotalAmount } = objec;

                    const seriesData = [];

                    seriesData.push({
                        name: 'Unmatched',
                        y: (Unmatch / Total) * 100
                    });
                    seriesData.push({
                        name: 'Matched',
                        y: (Match / Total) * 100
                    });
                    seriesData.push({
                        name: 'Proposed',
                        y: (Proposed / Total) * 100
                    });

                    return {
                        series: [
                            { name: 'Overview', data: seriesData }
                        ],
                    };
                } catch (error) {
                    showDigitalChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function DigitalOverAllChart2(containerId, chartType, matchType, roleName) {
                const data = await fetchDigitalChartDataOverAll1(matchType, roleName);
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }
                else {
                    //$("." + containerId).show();
                }

                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                    chart: {
                        renderTo: containerId,
                        type: chartType,
                        backgroundColor: 'rgba(255, 255, 255, 0.1)',
                        events: {
                            drilldown: function (e) {
                                //alert('Drilled down to ' + e.point.name);
                            }
                        }
                    },
                    title: {
                        text: 'Overall Transaction',
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Values',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.y:.1f}%',
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        pie: {
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Match Type',
                        colorByPoint: true,
                        data: data.series[0].data
                    }],

                };

                var chart = new Highcharts.Chart(chartOptions);

                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType
                        }
                    });
                });
            }
             DigitalOverAllChart2("DigitalOverAllChart2", "line", 0, "Admin");
              async function DigitalOverAllChart2(containerId, chartType, matchType, roleName) {
                    const data = await fetchDigitalChartDataOverAll1(matchType, roleName);

                    var chartOptions = {
                        colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                        chart: {
                            renderTo: containerId,
                            type: chartType,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            events: {
                                drilldown: function (e) {
                                    // alert('Drilled down to ' + e.point.name);
                                }
                            }
                        },
                        title: {
                            text: '',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '20px'
                            }
                        },
                        subtitle: {
                            text: '',
                            style: {
                                color: '#ff0000', // Red color for "Data not found" message
                                fontSize: '16px',
                            }
                        },
                        xAxis: {
                            type: 'category',
                            labels: {
                                style: {
                                    color: '#4CAF50'
                                }
                            }
                        },
                        yAxis: {
                            title: {
                                text: 'Values',
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '16px'
                                }
                            },
                            labels: {
                                style: {
                                    color: '#4CAF50'
                                }
                            }
                        },
                        legend: {
                            enabled: true,
                            itemStyle: {
                                color: '#4CAF50'
                            }
                        },
                        plotOptions: {
                            series: {
                                borderWidth: 0,
                                dataLabels: {
                                    enabled: true,
                                    format: '{point.name}: {point.y:.1f}%',
                                    style: {
                                        color: '#000000'
                                    }
                                }
                            },
                            pie: {
                                showInLegend: true
                            }
                        },
                        series: []
                    };

                    if (!data || !data.series || data.series.length === 0) {
                        chartOptions.title.text = "Data Not Found";
                        chartOptions.subtitle.text = "No data is available to display.";
                    } else {
                        chartOptions.title.text = "Overall Transaction";
                        chartOptions.series = [{
                            name: 'Match Type',
                            colorByPoint: true,
                            data: data.series[0].data
                        }];
                    }

                    var chart = new Highcharts.Chart(chartOptions);

                    document.getElementById('chartType').addEventListener('change', function () {
                        var newType = this.value;
                        chart.update({
                            chart: {
                                type: newType
                            }
                        });
                    });
                }

            DigitalOverAllChart2("DigitalOverAllChart2", "line", 0, "Admin");



            //----------------------------
            //------ Aging Chart 3 -------
            //----------------------------
            async function fetchDigitalChartDataAging() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Digital"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();


                    const { Aging } = apiResponse.SDT_ChartData;
                    if (Aging == undefined) {
                        showDigitalChartHideLoader()
                    }
                    else {
                        // Group data by SeriesName
                        const groupedData = Aging.reduce((acc, item) => {
                            if (!acc[item.SeriesName]) {
                                acc[item.SeriesName] = [];
                            }
                            acc[item.SeriesName].push({
                                name: item.Aging,
                                y: parseFloat(item.TotalAmount)
                            });
                            return acc;
                        }, {});

                        // Prepare data for Highcharts
                        const series = Object.keys(groupedData).map(seriesName => ({
                            name: seriesName,
                            colorByPoint: true,
                            data: groupedData[seriesName]
                        }));
                        showDigitalChartHideLoader()
                        return { series };
                    }
                } catch (error) {
                    showDigitalChartHideLoader()
                    Console.log('Error fetching data:' + error);
                }
            }
            async function DigitalAggingChart(containerId, chartType, title, type) {
                const data = await fetchDigitalChartDataAging();
                if (!data || !data.series || data.series.length === 0) {
                    return;
                } else {
                    $("." + containerId).show();
                }

                // Update series name based on type
                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                    chart: {
                        renderTo: containerId,
                        type: chartType,
                        backgroundColor: 'rgba(255, 255, 255, 0.1)',
                        events: {
                            drilldown: function (e) {
                                //alert('Drilled down to ' + e.point.name);
                            }
                        }
                    },
                    title: {
                        text: title,
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Y-Axis',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.name} Ago: {point.y:.1f}',
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        pie: {
                            showInLegend: true
                        }
                    },
                    series: data.series
                };
                var chart = new Highcharts.Chart(chartOptions);
                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType
                        }
                    });
                });
            }
            DigitalAggingChart("DigitalAggingChart", "line", "Agings", "DigitalLC");

            //----------------------------
            //--- DisputeAging Chart 4 ---
            //----------------------------
            async function LoadDigitalDisputesAggingData() {
                try {
                    let obj = {
                        "apiType": "Digital"
                    }
                    const response = await fetch('rest/prDisputesAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();

                    // Group data by Date
                    const groupedData = apiResponse.SDT_wpInvestigation.reduce((acc, item) => {
                        const date = new Date(item.CreationDate).toISOString().split('T')[0]; // Get 'YYYY-MM-DD' format
                        if (!acc[date]) {
                            acc[date] = [];
                        }
                        acc[date].push(item);
                        return acc;
                    }, {});

                    const result = Object.keys(groupedData).map(date => {
                        const count = groupedData[date].length;
                        const dateObj = new Date(date);
                        const daysOld = Math.floor((new Date() - dateObj) / (1000 * 60 * 60 * 24));

                        return {
                            Aging: daysOld === 0 ? "Today" : `${daysOld} days ago`,
                            Date: date,
                            SeriesName: groupedData[date][0].InvestigationSubject, // Use the first item's InvestigationSubject as SeriesName
                            Count: count
                        };
                    });

                    return result;

                } catch (error) {
                    showDigitalChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function DigitalDisputeAgingChart(containerId, chartType, title, type) {
                try {
                    const data = await LoadDigitalDisputesAggingData();

                    let chartOptions;

                    if (data && data.length > 0) {
                        // **Data Exists:** Configure the chart with the fetched data
                        const chartData = data.map(item => ({
                            name: item.Aging,
                            y: item.Count,
                            drilldown: item.Date
                        }));

                        chartOptions = {
                            colors: ['#7cb5ec', '#434348', '#90ed7d', '#f7a35c'],
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    drilldown: function (e) {
                                        // Custom drilldown logic if needed
                                        // Example: Set title to the drilldown category
                                        if (!e.seriesOptions) {
                                            this.setTitle({ text: e.point.name });
                                        }
                                    },
                                    drillup: function () {
                                        this.setTitle({ text: title });
                                    }
                                }
                            },
                            title: {
                                text: title,
                                style: {
                                    color: '#333333',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    style: {
                                        color: '#4CAF50'
                                    }
                                }
                            },
                            yAxis: {
                                title: {
                                    text: 'Count',
                                    style: {
                                        color: '#333333',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    style: {
                                        color: '#4CAF50'
                                    }
                                }
                            },
                            legend: {
                                enabled: true,
                                itemStyle: {
                                    color: '#4CAF50'
                                }
                            },
                            plotOptions: {
                                series: {
                                    borderWidth: 0,
                                    dataLabels: {
                                        enabled: true,
                                        format: '{point.name}: {point.y}',
                                        style: {
                                            color: '#000000'
                                        }
                                    }
                                },
                                pie: {
                                    showInLegend: true
                                }
                            },
                            series: [{
                                name: 'Dispute Aging',
                                data: chartData
                            }],
                            tooltip: {
                                formatter: function () {
                                    return `<b>${this.point.name}</b><br/>Count: ${this.point.y}`;
                                }
                            }
                        };
                    } else {
                        // **No Data:** Configure an empty chart with the specified title
                        chartOptions = {
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    load: function () {
                                        const chart = this;
                                        // Add a placeholder text in the center
                                        chart.renderer.text(
                                            'No data available',
                                            chart.plotWidth / 2 + chart.plotLeft,
                                            chart.plotHeight / 2 + chart.plotTop
                                        )
                                            .css({
                                                color: '#555555',
                                                fontSize: '16px',
                                                textAlign: 'center'
                                            })
                                            .attr({
                                                align: 'center'
                                            })
                                            .add();
                                    }
                                }
                            },
                            title: {
                                text: title, // "Disputes Aging"
                                style: {
                                    color: '#333333',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    enabled: false // Hide labels since there's no data
                                },
                                visible: false // Hide the X-axis entirely
                            },
                            yAxis: {
                                title: {
                                    text: 'Count',
                                    style: {
                                        color: '#333333',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    enabled: false // Hide labels since there's no data
                                },
                                visible: false // Hide the Y-axis entirely
                            },
                            legend: {
                                enabled: false // Disable the legend
                            },
                            series: [{
                                name: 'Dispute Aging',
                                data: [], // Empty data
                                dataLabels: {
                                    enabled: false // Disable data labels
                                }
                            }],
                            plotOptions: {
                                series: {
                                    dataLabels: {
                                        enabled: false // Disable data labels
                                    }
                                },
                                pie: {
                                    showInLegend: false
                                }
                            },
                            tooltip: {
                                enabled: false // Disable tooltips since there's no data
                            }
                        };
                    }

                    // **Render the Chart:** Always call Highcharts.chart with the configured options
                    const chart = Highcharts.chart(containerId, chartOptions);

                    // **Event Listener for Chart Type Change:**
                    // Ensure that the element with ID 'chartType' exists
                    const chartTypeSelector = document.getElementById('chartType');
                    if (chartTypeSelector) {
                        chartTypeSelector.addEventListener('change', function () {
                            const newType = this.value;
                            chart.update({
                                chart: {
                                    type: newType
                                }
                            });
                        });
                    }

                } catch (error) {
                    console.error('Error rendering chart:', error);

                    // **Render an Empty Chart with the Title in Case of Errors**
                    const emptyChartOptions = {
                        chart: {
                            type: chartType,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            events: {
                                load: function () {
                                    const chart = this;
                                    // Add a placeholder text in the center
                                    chart.renderer.text(
                                        'No data available',
                                        chart.plotWidth / 2 + chart.plotLeft,
                                        chart.plotHeight / 2 + chart.plotTop
                                    )
                                        .css({
                                            color: '#555555',
                                            fontSize: '16px',
                                            textAlign: 'center'
                                        })
                                        .attr({
                                            align: 'center'
                                        })
                                        .add();
                                }
                            }
                        },
                        title: {
                            text: title, // "Disputes Aging"
                            style: {
                                color: '#333333',
                                fontSize: '20px'
                            }
                        },
                        xAxis: {
                            type: 'category',
                            labels: {
                                enabled: false
                            },
                            visible: false
                        },
                        yAxis: {
                            title: {
                                text: 'Count',
                                style: {
                                    color: '#333333',
                                    fontSize: '16px'
                                }
                            },
                            labels: {
                                enabled: false
                            },
                            visible: false
                        },
                        legend: {
                            enabled: false
                        },
                        series: [{
                            name: 'Dispute Aging',
                            data: [],
                            dataLabels: {
                                enabled: false
                            }
                        }],
                        plotOptions: {
                            series: {
                                dataLabels: {
                                    enabled: false
                                }
                            },
                            pie: {
                                showInLegend: false
                            }
                        },
                        tooltip: {
                            enabled: false
                        }
                    };

                    Highcharts.chart(containerId, emptyChartOptions);
                }
            }
            DigitalDisputeAgingChart("DigitalDisputeAgingChart", "line", "Disputes Aging");
        }
        Digitalchart();
    }

    //________________________________________
    //______________ Cash ____________________
    //________________________________________
    function Cash() {
        //________________________________________________________
        //______________________ Commons _________________________
        //________________________________________________________
        hideCashCharts();
        function hideCashCharts() {
            $(".CashOverAllChart1").hide();
            $(".CashOverAllChart2").hide();
            $(".CashAggingChart").hide();
            $(".CashDisputeChart").hide();
            $(".CashDisputeAgingChart").hide();
        }
        function showCashChartHideLoader() {
            $(".chart-containers").hide();
            $(".CashDisputeChart").show();
            $(".CashAggingChart").show();
            $(".CashOverAllChart1").show();
            $(".CashOverAllChart2").show();
            $(".CashDisputeAgingChart").show();
        }

        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().split('T')[0];
        //const formattedDate = "2024-08-22"

        const lastWeekDate = new Date(currentDate);
        lastWeekDate.setDate(currentDate.getDate() - 7);
        const formattedDateLastWeek = lastWeekDate.toISOString().split('T')[0];

        //________________________________________________________
        //___________________ Dispute Table Cash _________________
        //________________________________________________________
        function CashDisputeTable() {
            async function LoadCashDesputesData() {
                try {
                    let obj = {
                        "apiType": "Cash"
                    }
                    const response = await fetch('rest/prDisputesAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const apiResponse = await response.json();
                    return apiResponse.SDT_wpInvestigation || [];
                } catch (error) {
                    showCashChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }

            let currentPageDigital = 1;
            const recordsPerPageDigital = 8;
            let disputesDataDigital = [];

            async function LoadDesputesGridCash() {
                disputesDataDigital = await LoadCashDesputesData();
                renderTableCash(currentPageDigital);
                setupPaginationCash();
            }
            function renderTableCash(page) {
                const startIndex = (page - 1) * recordsPerPageDigital;
                const endIndex = startIndex + recordsPerPageDigital;
                const paginatedData = disputesDataDigital.slice(startIndex, endIndex);

                const tableBody = document.querySelector('#CashDisputeData tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                paginatedData.forEach(item => {
                    const row = `
                            <tr class="GridWithPaginationBar GridWithBorderColor WorkWithOdd" data-investigation-case-id="${item.InvestigationCaseId}">
                                <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                    <p class="form-control-static"><span class="Attribute">${item.InvestigationCaseId}</span></p>
                                </td>
                                <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                    <p class="form-control-static"><span class="Attribute">${item.InvestigationAssigneeUserName}</span></p>
                                </td>
                                <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                    <p class="form-control-static"><span class="Attribute">${item.CreationDate}</span></p>
                                </td>
                            </tr>
                        `;
                    tableBody.insertAdjacentHTML('beforeend', row);
                });
                attachRowClickEventCash()
            }
            function attachRowClickEventCash() {
                $('#DigitalDisputeTable tbody').on('click', 'tr', function () {
                    const investigationCaseId = $(this).data('investigation-case-id');
                    if (investigationCaseId) {
                        const url = `wpinvestigationcase.aspx?InvestigationCaseId=${investigationCaseId}`;
                        window.location.href = url;
                    }
                });
            }
            function setupPaginationCash() {
                const totalPages = Math.ceil(disputesDataDigital.length / recordsPerPageDigital);
                const paginationBar = document.querySelector('.pagination');

                paginationBar.innerHTML = ''; // Clear existing pagination

                paginationBar.innerHTML += `<li class="prev ${currentPageDigital === 1 ? 'disabled' : ''}"><a href="#">Prev</a></li>`;

                for (let i = 1; i <= totalPages; i++) {
                    paginationBar.innerHTML += `<li class="${i === currentPageDigital ? 'active' : ''}"><a href="#">${i}</a></li>`;
                }

                paginationBar.innerHTML += `<li class="next ${currentPageDigital === totalPages ? 'disabled' : ''}"><a href="#">Next</a></li>`;
                setupPaginationEventsCash();
            }
            function setupPaginationEventsCash() {
                const paginationBar = document.querySelector('.pagination');

                paginationBar.addEventListener('click', function (e) {
                    e.preventDefault();

                    if (e.target.tagName === 'A') {
                        if (e.target.parentElement.classList.contains('prev') && currentPageDigital > 1) {
                            currentPageDigital--;
                        } else if (e.target.parentElement.classList.contains('next') && currentPageDigital < Math.ceil(disputesDataDigital.length / recordsPerPageDigital)) {
                            currentPageDigital++;
                        } else if (!e.target.parentElement.classList.contains('prev') && !e.target.parentElement.classList.contains('next')) {
                            currentPageDigital = parseInt(e.target.textContent, 10);
                        }
                        renderTable(currentPageDigital);
                        setupPaginationCash();
                    }
                });
            }
            document.addEventListener('DOMContentLoaded', LoadDesputesGridCash);
        }
        CashDisputeTable();

        //________________________________________________________
        //______________________ Cards ___________________________
        //________________________________________________________
        function LoadCardsCash() {
            function LoadHeaderCardUICash() {
                var headerCartDigital = `
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_1 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalTxtCash" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color: #177a9a ">
                                            <i class="fas fa-chart-bar"></i>
                                        </div>
                                    </div>
                                </div>
                                <!--<p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercCash" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Transaction</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6  col-sm-6">
                        <div class="card card-stats card_5-match  mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">MATCHED</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="matchTxtCash">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape-matched text-white rounded-circle shadow">
                                            <i class="fas fa-chart-pie" style="font-size: 1.25rem"></i>
                                        </div>
                                    </div>
                                </div>
                               <!-- <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="matchPercCash" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">Matched Transaction</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_6-proposed mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">PROPOSED</h5>
                                        <span class="h2 font-weight-bold mb-0" id="proposedTxtCash" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape-proposed text-white rounded-circle shadow">
                                            <i class="fas fa-cubes"  style="font-size: 1.25rem"></i>
                                        </div>
                                    </div>
                                </div>
                               <!-- <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="proposedPercCash"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">Proposed Transaction</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_7-unMatched mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">UNMATCHED</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="unMatchedTxtCash">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape-unmatched text-white rounded-circle shadow">
                                            <i class="fas fa-percent"  style="font-size: 1.25rem"></i>
                                        </div>
                                    </div>
                                </div>
                               <!-- <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="unMatchedPercCash" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">Unmatch Transaction</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    `;
                $("#CashTransactionCards").html(headerCartDigital);

                var headerCartCircleAmountDigital = `<div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
                                    <div class="chart-containerCircel" style="height:73px; background-color: #177a9a24; border: 2px solid #177a9a; box-shadow: 2px 2px 5px #00000063;">
                                        <div class="chart-info-wrapper">
                                            <h2>Total</h2>
                                            <span class="totalAmountTxtCash">Rs 0</span>
                                        </div>
                                        <div class="chart-svg " style="margin-top:15px">
                                            <svg viewBox="0 0 42 42" class="circular-chart systemColor">
                                                <path class="circle-bg" d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <path class="circle totalCircle" stroke-dasharray="0, 100" d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <text x="18" y="20.35" class="percentage totalPercCash">0%</text>
                                            </svg>
                                        </div>
                                    </div>
                    </div>
                    <div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
                                    <div class="chart-containerCircel chart-containerCircel-matched" style="background-color: #cfe6de;">
                                        <div class="chart-info-wrapper">
                                            <h2>Matched</h2>
                                            <span class="matchAmountTxtCash">Rs 0</span>
                                        </div>
                                        <div class="chart-svg" style="margin-top:15px">
                                            <svg viewBox="0 0 42 42" class="circular-chart blue">
                                                <path class="circle-bg" d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <path class="circle matchCircle" style="stroke:#058a22" stroke-dasharray="0, 100" d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <text x="18" y="20.35" class="percentage matchPercCash">0%</text>
                                            </svg>
                                        </div>
                                    </div>
                    </div>
                    <div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
                                    <div class="chart-containerCircel chart-containerCircel-proposed" style="background-color: #f1c0932b">
                                        <div class="chart-info-wrapper">
                                            <h2>Proposed</h2>
                                            <span class="proposedAmountTxtCash">Rs 0</span>
                                        </div>
                                        <div class="chart-svg" style="margin-top:15px">
                                            <svg viewBox="0 0 42 42" class="circular-chart orange">
                                                <path class="circle-bg" d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <path class="circle proposedCircle" style="stroke:#fe8612" stroke-dasharray="0, 100" d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <text x="18" y="20.35" class="percentage proposedPercCash">0%</text>
                                            </svg>
                                        </div>
                                    </div>
                    </div>
                    <div class="col-xs-6 col-md-3 col-lg-3" style="margin-top:15px">
                                    <div class="chart-containerCircel chart-containerCircel chart-containerCircel-unmatched" style="background-color: #b70e0e29;">
                                        <div class="chart-info-wrapper">
                                            <h2>Unmatched</h2>
                                            <span class="unMatchedAmountTxtCash">Rs 0</span>
                                        </div>
                                        <div class="chart-svg" style="margin-top:15px">
                                            <svg viewBox="0 0 42 42" class="circular-chart darklight">
                                                <path class="circle-bg" d="M18 2.0845
                                    a 15.9155 15.9155 0 0 1 0 31.831
                                    a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <path class="circle unmatchedCircle" style="stroke:#bd1c1c !important" stroke-dasharray="0, 100" d="M18 2.0845
                                    a 15.9155 15.9155 0 0 1 0 31.831
                                    a 15.9155 15.9155 0 0 1 0 -31.831"></path>
                                                <text x="18" y="20.35" class="percentage unMatchedPercCash">0%</text>
                                            </svg>
                                        </div>
                                    </div>
                    </div>`;
                $("#CashAmountCards").html(headerCartCircleAmountDigital);
            }
            LoadHeaderCardUICash()
            async function SetCashCardsData() {
                try {
                    let obj = {
                        "dateTime": formattedDate,//"2024-07-29",
                        "ApiType": "Cash"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, TotalStatistics } = apiResponse.SDT_ChartData;
                    const [objec] = TotalStatistics;

                    //_______ Total and Amount _____
                    const { Match, Unmatch, Proposed, Total, MatchAmount, UnmatchAmount, ProposedAmount, TotalAmount } = objec;
                    if (TotalStatistics.length > 0) {
                        $("#totalTxtCash").text(Total);
                        $("#matchTxtCash").text(Match);
                        $("#proposedTxtCash").text(Proposed);
                        $("#unMatchedTxtCash").text(Unmatch);

                        $(".totalAmountTxtCash").text(formatCurrencyCash(TotalAmount));
                        $(".matchAmountTxtCash").text(formatCurrencyCash(MatchAmount));
                        $(".proposedAmountTxtCash").text(formatCurrencyCash(ProposedAmount));
                        $(".unMatchedAmountTxtCash").text(formatCurrencyCash(UnmatchAmount));

                    }

                    if (Total > 0) {
                        // Percentage
                        matchedPer = ((parseFloat(Match) / parseFloat(Total)) * 100).toFixed(1) + '%';
                        proposedPer = ((parseFloat(Proposed) / parseFloat(Total)) * 100).toFixed(1) + '%';
                        unmatchedPer = ((parseFloat(Unmatch) / parseFloat(Total)) * 100).toFixed(1) + '%';
                        $(".unMatchedPercCash").text(unmatchedPer);
                        $(".proposedPercCash").text(proposedPer);
                        $(".matchPercCash").text(matchedPer);
                        $(".totalPercCash").text("100%");

                        //circle
                        $(".circle.totalCircle").attr("stroke-dasharray", (parseFloat(100) + ", 100"));
                        $(".circle.matchCircle").attr("stroke-dasharray", (parseFloat(matchedPer) + ", 100"));
                        $(".circle.proposedCircle").attr("stroke-dasharray", (parseFloat(proposedPer) + ", 100"));
                        $(".circle.unmatchedCircle").attr("stroke-dasharray", (parseFloat(unmatchedPer) + ", 100"));

                        //Progress   Class change krna wali rhteee haa
                        $(".progress_number_digital_total").text('100%');
                        $(".progress_number_digital_matched").text(matchedPer);
                        $(".progress_number_digital_proposed").text(proposedPer);
                        $(".progress_number_digital_unmatched").text(unmatchedPer);

                        $(".progress-bar-inner-total-digital").css("width", '100%');
                        $(".progress-bar-inner-matched-digital").css("width", matchedPer);
                        $(".progress-bar-inner-proposed-digital").css("width", proposedPer);
                        $(".progress-bar-inner-unmatched-digital").css("width", unmatchedPer);
                    }


                } catch (error) {
                    showDigitalChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            SetCashCardsData();
            function formatCurrencyCash(amount) {
                const formatter = new Intl.NumberFormat('en-PK', {
                    style: 'currency',
                    currency: 'PKR',
                });



                return formatter.format(amount);
            }
        }
        LoadCardsCash()

        //________________________________________________________
        //______________________ Chart ___________________________
        //________________________________________________________
        function Cashchart() {
            document.getElementById('CashOverAllChartType1').addEventListener('change', function () {
                updateChartCash('CashOverAllChart1', this.value);
            });
            document.getElementById('CashOverAllChartType2').addEventListener('change', function () {
                updateChartCash('CashOverAllChart2', this.value);
            });
            document.getElementById('CashAggingChartType').addEventListener('change', function () {
                updateChartCash('CashAggingChart', this.value);
            });
            document.getElementById('CashDisputeAgingChartType').addEventListener('change', function () {
                updateChartCash('CashDisputeAgingChart', this.value);
            });

            function updateChartCash(chartId, chartType) {
                if (chartId == "CashOverAllChart1") {
                    CashOverAllChart1(chartId, chartType, "Transaction Amount", formattedDate);
                }
                else if (chartId == "CashOverAllChart2") {
                    CashOverAllChart2(chartId, chartType);
                }
                else if (chartId == "CashAggingChart") {
                    CashAggingChart(chartId, chartType, 'Amount Aging');
                }
                else if (chartId == "CashDisputeAgingChart") {
                    CashDisputeAgingChart(chartId, chartType, "Disputes Aging", "");
                }
            }

            //----------------------------
            //---- Over All Chart 1 ------
            //----------------------------
            async function fetchCashChartDataOverAll(date) {
                try {
                    let obj = {
                        "dateTime": date,
                        "ApiType": "Cash"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3 } = apiResponse.SDT_ChartData || {};

                    const colors = ['#7cb5ec', '#434348', '#90ed7d', '#f7a35c', '#8085e9', '#f15c80', '#e4d354', '#8d4654', '#91e8e1'];
                    const series = Array.isArray(Data) ? [{
                        name: 'Transaction Amount',
                        colorByPoint: true,
                        data: Data.map((parent, index) => ({
                            name: parent.TrLifeCycleName,
                            y: parseFloat(parent.TotalAmount),
                            drilldown: parent.UniqueKey, // Ensure this matches the id in drilldownSeries
                            color: colors[index % colors.length]
                        }))
                    }] : [];

                    const drilldownSeries = Array.isArray(Level1) ? Level1.map(item => ({
                        name: item.AccName,
                        id: item.UniqueKey,
                        data: Level1
                            .filter(l2 => l2.UniqueKey.startsWith(item.UniqueKey))
                            .map(l2 => [l2.AccName, parseFloat(l2.TotalAmount)])
                    })) : [];

                    if (Array.isArray(Level2) && Array.isArray(Level3)) {
                        Level2.forEach(item => {
                            drilldownSeries.push({
                                name: item.MatchStatus,
                                id: item.UniqueKey,
                                data: Level3
                                    .filter(l3 => l3.UniqueKey.startsWith(item.UniqueKey))
                                    .map(l3 => [l3.MatchStatus, parseFloat(l3.Amount)])
                            });
                        });
                    }

                    return {
                        series: series,
                        drilldown: {
                            series: drilldownSeries
                        }
                    };
                } catch (error) {
                    showDigitalChartHideLoader();
                    console.log('Error fetching data: ' + error.message);
                }
            }

            async function CashOverAllChart1(containerId, chartType, title, date) {
                try {
                    const data = await fetchCashChartDataOverAll(date);

                    let chartOptions;

                    if (data && data.series && data.series.length > 0) {
                        // Data exists: Configure the chart with the fetched data
                        chartOptions = {
                            colors: ['#7cb5ec', '#434348', '#90ed7d', '#f7a35c', '#8085e9', '#f15c80', '#e4d354', '#8d4654', '#91e8e1'],
                            chart: {
                                renderTo: containerId,
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    drilldown: function (e) {
                                        this.setTitle({ text: e.point.name });
                                    },
                                    drillup: function (e) {
                                        this.setTitle({ text: title });
                                    }
                                }
                            },
                            title: {
                                text: title,
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    style: {
                                        color: '#2b908f'
                                    }
                                }
                            },
                            yAxis: {
                                title: {
                                    text: 'Values',
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)'
                                    },
                                    formatter: function () {
                                        return this.value === 0 ? '' : this.value;
                                    }
                                }
                            },
                            legend: {
                                enabled: false
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '{point.name}: {point.y:.2f} ({point.percentage:.2f}%)',
                                        style: {
                                            color: '#000000'
                                        }
                                    },
                                    showInLegend: true
                                }
                            },
                            series: data.series,
                            drilldown: {
                                series: data.drilldown.series || [],
                                drillUpButton: {
                                    relativeTo: 'spacingBox',
                                    position: {
                                        y: 0,
                                        x: 0
                                    },
                                    theme: {
                                        fill: 'white',
                                        'stroke-width': 1,
                                        stroke: 'silver',
                                        r: 0
                                    }
                                }
                            },
                            tooltip: {
                                formatter: function () {
                                    if (this.point.drilldown) {
                                        return `<b>${this.point.name}</b><br/>Total Amount: ${Highcharts.numberFormat(this.y, 2)} (${Highcharts.numberFormat(this.percentage, 2)}%)`;
                                    } else {
                                        return `<b>${this.point.name}</b><br/>${Highcharts.numberFormat(this.y, 2)} (${Highcharts.numberFormat(this.percentage, 2)}%)`;
                                    }
                                }
                            }
                        };
                    } else {
                        // No data: Configure an empty chart
                        chartOptions = {
                            chart: {
                                renderTo: containerId,
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)'
                            },
                            title: {
                                text: title,
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                visible: false
                            },
                            yAxis: {
                                visible: false
                            },
                            legend: {
                                enabled: false
                            },
                            series: [{
                                name: 'Empty',
                                data: [] // No data
                            }],
                            tooltip: {
                                enabled: false
                            }
                        };
                    }

                    // Render the chart
                    Highcharts.chart(containerId, chartOptions);
                } catch (error) {
                    console.error('Error rendering chart:', error);

                    // Render an empty chart with the title in case of errors
                    Highcharts.chart(containerId, {
                        chart: {
                            renderTo: containerId,
                            type: chartType,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)'
                        },
                        title: {
                            text: title,
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '20px'
                            }
                        },
                        xAxis: {
                            visible: false
                        },
                        yAxis: {
                            visible: false
                        },
                        legend: {
                            enabled: false
                        },
                        series: [{
                            name: 'Empty',
                            data: [] // No data
                        }],
                        tooltip: {
                            enabled: false
                        }
                    });
                }
            }
            // Call the function
            CashOverAllChart1("CashOverAllChart1", "pie", "Transaction Amount", formattedDate);


            //----------------------------
            //---- Over All Chart 2 ------
            //----------------------------
            async function fetchCashChartDataOverAll1() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Cash"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, TotalStatistics } = apiResponse.SDT_ChartData;
                    const [objec] = TotalStatistics;
                    const { Match, Unmatch, Proposed, Total, MatchAmount, UnmatchAmount, ProposedAmount, TotalAmount } = objec;

                    const seriesData = [];

                    seriesData.push({
                        name: 'Unmatched',
                        y: (Unmatch / Total) * 100
                    });
                    seriesData.push({
                        name: 'Matched',
                        y: (Match / Total) * 100
                    });
                    seriesData.push({
                        name: 'Proposed',
                        y: (Proposed / Total) * 100
                    });

                    return {
                        series: [
                            { name: 'Overview', data: seriesData }
                        ],
                    };
                } catch (error) {
                    showCashChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function CashOverAllChart2(containerId, chartType, matchType, roleName) {
                const data = await fetchCashChartDataOverAll1(matchType, roleName);
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }
                else {
                    //$("." + containerId).show();
                }

                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                    chart: {
                        renderTo: containerId,
                        type: chartType,
                        backgroundColor: 'rgba(255, 255, 255, 0.1)',
                        events: {
                            drilldown: function (e) {
                                //alert('Drilled down to ' + e.point.name);
                            }
                        }
                    },
                    title: {
                        text: 'Overall Transaction',
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Values',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.y:.1f}%',
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        pie: {
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Match Type',
                        colorByPoint: true,
                        data: data.series[0].data
                    }],

                };

                var chart = new Highcharts.Chart(chartOptions);

                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType
                        }
                    });
                });
            }
            CashOverAllChart2("CashOverAllChart2", "line", 0, "Admin");

            //----------------------------
            //------ Aging Chart 3 -------
            //----------------------------
            async function fetchCashChartDataAging() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Cash"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();


                    const { Aging } = apiResponse.SDT_ChartData;
                    if (Aging == undefined) {
                        showCashChartHideLoader()
                    }
                    else {
                        // Group data by SeriesName
                        const groupedData = Aging.reduce((acc, item) => {
                            if (!acc[item.SeriesName]) {
                                acc[item.SeriesName] = [];
                            }
                            acc[item.SeriesName].push({
                                name: item.Aging,
                                y: parseFloat(item.TotalAmount)
                            });
                            return acc;
                        }, {});

                        // Prepare data for Highcharts
                        const series = Object.keys(groupedData).map(seriesName => ({
                            name: seriesName,
                            colorByPoint: true,
                            data: groupedData[seriesName]
                        }));
                        showCashChartHideLoader()
                        return { series };
                    }
                } catch (error) {
                    showCashChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function CashAggingChart(containerId, chartType, title, type) {
                try {
                    const data = await fetchCashChartDataAging();

                    let chartOptions;

                    if (data && data.series && data.series.length > 0) {
                        // **Data Exists:** Configure the chart with the fetched data
                        chartOptions = {
                            colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    drilldown: function (e) {
                                        // Custom drilldown logic if needed
                                        // Example: Set title to the drilldown category
                                        if (!e.seriesOptions) {
                                            this.setTitle({ text: e.point.name });
                                        }
                                    },
                                    drillup: function () {
                                        this.setTitle({ text: title });
                                    }
                                }
                            },
                            title: {
                                text: title,
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    style: {
                                        color: '#4CAF50'
                                    }
                                }
                            },
                            yAxis: {
                                title: {
                                    text: 'Y-Axis',
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    style: {
                                        color: '#4CAF50'
                                    }
                                }
                            },
                            legend: {
                                enabled: true,
                                itemStyle: {
                                    color: '#4CAF50'
                                }
                            },
                            plotOptions: {
                                series: {
                                    borderWidth: 0,
                                    dataLabels: {
                                        enabled: true,
                                        format: '{point.name} Ago: {point.y:.1f}',
                                        style: {
                                            color: '#000000'
                                        }
                                    }
                                },
                                pie: {
                                    showInLegend: true
                                }
                            },
                            series: data.series,
                            tooltip: {
                                formatter: function () {
                                    return `<b>${this.point.name}</b><br/>Ago: ${this.point.y.toFixed(1)}`;
                                }
                            }
                        };
                    } else {
                        // **No Data:** Configure an empty chart with the title and a placeholder message
                        chartOptions = {
                            colors: ['#d3d3d3'], // Light gray color for empty chart
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    load: function () {
                                        const chart = this;
                                        // Add a placeholder text in the center
                                        chart.renderer.text(
                                            'No data available',
                                            chart.plotWidth / 2 + chart.plotLeft,
                                            chart.plotHeight / 2 + chart.plotTop
                                        )
                                            .css({
                                                color: '#555555',
                                                fontSize: '16px',
                                                textAlign: 'center'
                                            })
                                            .attr({
                                                align: 'center'
                                            })
                                            .add();
                                    },
                                    drilldown: function () {
                                        // Prevent drilldown when no data
                                    },
                                    drillup: function () {
                                        // Prevent drillup when no data
                                    }
                                }
                            },
                            title: {
                                text: title, // "Agings"
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                visible: false // Hide the X-axis
                            },
                            yAxis: {
                                visible: false, // Hide the Y-axis
                                title: {
                                    text: 'Y-Axis',
                                    style: {
                                        color: 'var(--colors_materialmenu_selecteditembackground)',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    enabled: false // Hide labels since there's no data
                                }
                            },
                            legend: {
                                enabled: false // Disable the legend
                            },
                            series: [{
                                name: 'Agings',
                                data: [], // No data
                                dataLabels: {
                                    enabled: false // Disable data labels
                                }
                            }],
                            plotOptions: {
                                series: {
                                    dataLabels: {
                                        enabled: false // Disable data labels
                                    }
                                },
                                pie: {
                                    showInLegend: false
                                }
                            },
                            tooltip: {
                                enabled: false // Disable tooltips since there's no data
                            }
                        };
                    }

                    // **Render the Chart:** Always call Highcharts.chart with the configured options
                    const chart = Highcharts.chart(containerId, chartOptions);

                    // **Event Listener for Chart Type Change:**
                    // Ensure that the element with ID 'chartType' exists
                    const chartTypeSelector = document.getElementById('chartType');
                    if (chartTypeSelector) {
                        chartTypeSelector.addEventListener('change', function () {
                            const newType = this.value;
                            chart.update({
                                chart: {
                                    type: newType
                                }
                            });
                        });
                    }

                } catch (error) {
                    console.error('Error rendering Cash Aging chart:', error);

                    // **Render an Empty Chart with the Title and Placeholder Message in Case of Errors**
                    const emptyChartOptions = {
                        colors: ['#d3d3d3'], // Light gray color for empty chart
                        chart: {
                            type: chartType,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            events: {
                                load: function () {
                                    const chart = this;
                                    // Add a placeholder text in the center
                                    chart.renderer.text(
                                        'No data available',
                                        chart.plotWidth / 2 + chart.plotLeft,
                                        chart.plotHeight / 2 + chart.plotTop
                                    )
                                        .css({
                                            color: '#555555',
                                            fontSize: '16px',
                                            textAlign: 'center'
                                        })
                                        .attr({
                                            align: 'center'
                                        })
                                        .add();
                                },
                                drilldown: function () {
                                    // Prevent drilldown when no data
                                },
                                drillup: function () {
                                    // Prevent drillup when no data
                                }
                            }
                        },
                        title: {
                            text: title, // "Agings"
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '20px'
                            }
                        },
                        xAxis: {
                            visible: false // Hide the X-axis
                        },
                        yAxis: {
                            visible: false, // Hide the Y-axis
                            title: {
                                text: 'Y-Axis',
                                style: {
                                    color: 'var(--colors_materialmenu_selecteditembackground)',
                                    fontSize: '16px'
                                }
                            },
                            labels: {
                                enabled: false // Hide labels since there's no data
                            }
                        },
                        legend: {
                            enabled: false // Disable the legend
                        },
                        series: [{
                            name: 'Agings',
                            data: [], // No data
                            dataLabels: {
                                enabled: false // Disable data labels
                            }
                        }],
                        plotOptions: {
                            series: {
                                dataLabels: {
                                    enabled: false // Disable data labels
                                }
                            },
                            pie: {
                                showInLegend: false
                            }
                        },
                        tooltip: {
                            enabled: false // Disable tooltips since there's no data
                        }
                    };

                    Highcharts.chart(containerId, emptyChartOptions);
                }
            }

            CashAggingChart("CashAggingChart", "line", "Agings", "DigitalLC");

            //----------------------------
            //--- DisputeAging Chart 4 ---
            //----------------------------
            async function LoadCashDisputesAggingData() {
                try {
                    let obj = {
                        "apiType": "Cash"
                    }
                    const response = await fetch('rest/prDisputesAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();

                    // Group data by Date
                    const groupedData = apiResponse.SDT_wpInvestigation.reduce((acc, item) => {
                        const date = new Date(item.CreationDate).toISOString().split('T')[0]; // Get 'YYYY-MM-DD' format
                        if (!acc[date]) {
                            acc[date] = [];
                        }
                        acc[date].push(item);
                        return acc;
                    }, {});

                    const result = Object.keys(groupedData).map(date => {
                        const count = groupedData[date].length;
                        const dateObj = new Date(date);
                        const daysOld = Math.floor((new Date() - dateObj) / (1000 * 60 * 60 * 24));

                        return {
                            Aging: daysOld === 0 ? "Today" : `${daysOld} days ago`,
                            Date: date,
                            SeriesName: groupedData[date][0].InvestigationSubject, // Use the first item's InvestigationSubject as SeriesName
                            Count: count
                        };
                    });

                    return result;

                } catch (error) {
                    showCashChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function CashDisputeAgingChart(containerId, chartType, title, type) {
                try {
                    const data = await LoadCashDisputesAggingData();

                    let chartOptions;

                    if (data && data.length > 0) {
                        // **Data Exists:** Configure the chart with the fetched data
                        const chartData = data.map(item => ({
                            name: item.Aging,
                            y: item.Count,
                            drilldown: item.Date
                        }));

                        chartOptions = {
                            colors: ['#7cb5ec', '#434348', '#90ed7d', '#f7a35c'],
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    drilldown: function (e) {
                                        // Custom drilldown logic if needed
                                        // Example: Set title to the drilldown category
                                        if (!e.seriesOptions) {
                                            this.setTitle({ text: e.point.name });
                                        }
                                    },
                                    drillup: function () {
                                        this.setTitle({ text: title });
                                    }
                                }
                            },
                            title: {
                                text: title,
                                style: {
                                    color: '#333333',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                labels: {
                                    style: {
                                        color: '#4CAF50'
                                    }
                                }
                            },
                            yAxis: {
                                title: {
                                    text: 'Count',
                                    style: {
                                        color: '#333333',
                                        fontSize: '16px'
                                    }
                                },
                                labels: {
                                    style: {
                                        color: '#4CAF50'
                                    }
                                }
                            },
                            legend: {
                                enabled: true,
                                itemStyle: {
                                    color: '#4CAF50'
                                }
                            },
                            plotOptions: {
                                series: {
                                    borderWidth: 0,
                                    dataLabels: {
                                        enabled: true,
                                        format: '{point.name}: {point.y}',
                                        style: {
                                            color: '#000000'
                                        }
                                    }
                                },
                                pie: {
                                    showInLegend: true
                                }
                            },
                            series: [{
                                name: 'Dispute Aging',
                                data: chartData
                            }],
                            tooltip: {
                                formatter: function () {
                                    return `<b>${this.point.name}</b><br/>Count: ${this.point.y}`;
                                }
                            }
                        };
                    } else {
                        // **No Data:** Configure an empty chart with a placeholder message
                        chartOptions = {
                            chart: {
                                type: chartType,
                                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                                events: {
                                    load: function () {
                                        const chart = this;
                                        // Add a placeholder text in the center
                                        chart.renderer.text(
                                            'No data available',
                                            chart.plotWidth / 2 + chart.plotLeft,
                                            chart.plotHeight / 2 + chart.plotTop
                                        )
                                            .css({
                                                color: '#555555',
                                                fontSize: '16px',
                                                textAlign: 'center'
                                            })
                                            .attr({
                                                align: 'center'
                                            })
                                            .add();
                                    },
                                    drilldown: function () {
                                        // Prevent drilldown when no data
                                    },
                                    drillup: function () {
                                        // Prevent drillup when no data
                                    }
                                }
                            },
                            title: {
                                text: title,
                                style: {
                                    color: '#333333',
                                    fontSize: '20px'
                                }
                            },
                            xAxis: {
                                visible: false // Hide the X-axis
                            },
                            yAxis: {
                                visible: false // Hide the Y-axis
                            },
                            legend: {
                                enabled: false // Disable the legend
                            },
                            series: [{
                                name: 'Dispute Aging',
                                data: [] // No data
                            }],
                            tooltip: {
                                enabled: false // Disable tooltips
                            }
                        };
                    }

                    // **Render the Chart:** Always call Highcharts.chart with the configured options
                    const chart = Highcharts.chart(containerId, chartOptions);

                    // **Event Listener for Chart Type Change:**
                    // Ensure that the element with ID 'chartType' exists
                    const chartTypeSelector = document.getElementById('chartType');
                    if (chartTypeSelector) {
                        chartTypeSelector.addEventListener('change', function () {
                            const newType = this.value;
                            chart.update({
                                chart: {
                                    type: newType
                                }
                            });
                        });
                    }

                } catch (error) {
                    console.error('Error rendering chart:', error);

                    // **Render an Empty Chart with the Title and Placeholder Message in Case of Errors**
                    const emptyChartOptions = {
                        chart: {
                            type: chartType,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            events: {
                                load: function () {
                                    const chart = this;
                                    // Add a placeholder text in the center
                                    chart.renderer.text(
                                        'No data available',
                                        chart.plotWidth / 2 + chart.plotLeft,
                                        chart.plotHeight / 2 + chart.plotTop
                                    )
                                        .css({
                                            color: '#555555',
                                            fontSize: '16px',
                                            textAlign: 'center'
                                        })
                                        .attr({
                                            align: 'center'
                                        })
                                        .add();
                                },
                                drilldown: function () {
                                    // Prevent drilldown when no data
                                },
                                drillup: function () {
                                    // Prevent drillup when no data
                                }
                            }
                        },
                        title: {
                            text: title,
                            style: {
                                color: '#333333',
                                fontSize: '20px'
                            }
                        },
                        xAxis: {
                            visible: false // Hide the X-axis
                        },
                        yAxis: {
                            visible: false // Hide the Y-axis
                        },
                        legend: {
                            enabled: false // Disable the legend
                        },
                        series: [{
                            name: 'Dispute Aging',
                            data: [] // No data
                        }],
                        tooltip: {
                            enabled: false // Disable tooltips
                        }
                    };

                    Highcharts.chart(containerId, emptyChartOptions);
                }
            }

            CashDisputeAgingChart("CashDisputeAgingChart", "line", "Disputes Aging");
        }
        Cashchart();
    }

    //________________________________________
    //______________ Transformer ____________________
    //________________________________________
    function Transformer() {
        //________________________________________________________
        //______________________ Commons _________________________
        //________________________________________________________
        hideTransformerCharts();
        function hideTransformerCharts() {
            $(".EltDataLoadingFileChart").hide();
            $(".APIUploadChart").hide();
            $(".DBChartLoad").hide();
            $(".TransformerOverAllChart1").hide();
            $(".TransformerOverAllDestCount").hide();
            $(".TransformerOverAllSourceCount").hide();
            $(".TransformerAggingChart").hide();
            $(".TransformerDisputeChart").hide();
            $(".TransformerDisputeAgingChart").hide();
        }
        function showTransformerChartHideLoader() {
            $(".chart-containers").hide();
            $(".TransformerDisputeChart").show();
            $(".TransformerAggingChart").show();
            $(".EltDataLoadingFileChart").show();
            $(".DBChartLoad").show();
            $(".APIUploadChart").show();
            $(".TransformerOverAllChart1").show();
            $(".TransformerOverAllDestCount").show();
            $(".TransformerOverAllSourceCount").show();
            $(".TransformerDisputeAgingChart").show();
        }

        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().split('T')[0];
        //const formattedDate = "2024-08-22"

        const lastWeekDate = new Date(currentDate);
        lastWeekDate.setDate(currentDate.getDate() - 7);
        const formattedDateLastWeek = lastWeekDate.toISOString().split('T')[0];

        //________________________________________________________
        //___________________ Dispute Table Transformer _________________
        //________________________________________________________
        function TransformerDisputeTable() {
            async function LoadTransformerDesputesData() {
                try {
                    let obj = {
                        "apiType": "Transformer"
                    }
                    const response = await fetch('rest/prDisputesAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const apiResponse = await response.json();
                    return apiResponse.SDT_wpInvestigation || [];
                } catch (error) {
                    showTransformerChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }

            let currentPageDigital = 1;
            const recordsPerPageDigital = 8;
            let disputesDataDigital = [];

            async function LoadDesputesGridTransformer() {
                disputesDataDigital = await LoadTransformerDesputesData();
                renderTableTransformer(currentPageDigital);
                setupPaginationTransformer();
            }
            function renderTableTransformer(page) {
                const startIndex = (page - 1) * recordsPerPageDigital;
                const endIndex = startIndex + recordsPerPageDigital;
                const paginatedData = disputesDataDigital.slice(startIndex, endIndex);

                const tableBody = document.querySelector('#TransformerDisputeData tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                paginatedData.forEach(item => {
                    const row = `
                            <tr class="GridWithPaginationBar GridWithBorderColor WorkWithOdd" data-investigation-case-id="${item.InvestigationCaseId}">
                                <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                    <p class="form-control-static"><span class="Attribute">${item.InvestigationCaseId}</span></p>
                                </td>
                                <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                    <p class="form-control-static"><span class="Attribute">${item.InvestigationAssigneeUserName}</span></p>
                                </td>
                                <td class="gx-tab-padding-fix-1 gx-attribute WWColumn" style="text-align:start;">
                                    <p class="form-control-static"><span class="Attribute">${item.CreationDate}</span></p>
                                </td>
                            </tr>
                        `;
                    tableBody.insertAdjacentHTML('beforeend', row);
                });
                attachRowClickEventTransformer()
            }
            function attachRowClickEventTransformer() {
                $('#DigitalDisputeTable tbody').on('click', 'tr', function () {
                    const investigationCaseId = $(this).data('investigation-case-id');
                    if (investigationCaseId) {
                        const url = `wpinvestigationcase.aspx?InvestigationCaseId=${investigationCaseId}`;
                        window.location.href = url;
                    }
                });
            }
            function setupPaginationTransformer() {
                const totalPages = Math.ceil(disputesDataDigital.length / recordsPerPageDigital);
                const paginationBar = document.querySelector('.pagination');

                paginationBar.innerHTML = ''; // Clear existing pagination

                paginationBar.innerHTML += `<li class="prev ${currentPageDigital === 1 ? 'disabled' : ''}"><a href="#">Prev</a></li>`;

                for (let i = 1; i <= totalPages; i++) {
                    paginationBar.innerHTML += `<li class="${i === currentPageDigital ? 'active' : ''}"><a href="#">${i}</a></li>`;
                }

                paginationBar.innerHTML += `<li class="next ${currentPageDigital === totalPages ? 'disabled' : ''}"><a href="#">Next</a></li>`;
                setupPaginationEventsCash();
            }
            function setupPaginationEventsCash() {
                const paginationBar = document.querySelector('.pagination');

                paginationBar.addEventListener('click', function (e) {
                    e.preventDefault();

                    if (e.target.tagName === 'A') {
                        if (e.target.parentElement.classList.contains('prev') && currentPageDigital > 1) {
                            currentPageDigital--;
                        } else if (e.target.parentElement.classList.contains('next') && currentPageDigital < Math.ceil(disputesDataDigital.length / recordsPerPageDigital)) {
                            currentPageDigital++;
                        } else if (!e.target.parentElement.classList.contains('prev') && !e.target.parentElement.classList.contains('next')) {
                            currentPageDigital = parseInt(e.target.textContent, 10);
                        }
                        renderTable(currentPageDigital);
                        setupPaginationCash();
                    }
                });
            }
            document.addEventListener('DOMContentLoaded', LoadDesputesGridTransformer);
        }
        TransformerDisputeTable();

        //________________________________________________________
        //______________________ Cards ___________________________
        //________________________________________________________
        function LoadCardsTransformer() {
            function LoadHeaderCardUITransformer() {
                var headerCartTransformer = `
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_1 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body" >
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL SOURCE</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalTxtSource" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#177a9a;">
                                            <i class="fas fa-globe"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercSource" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Source</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6  col-sm-6">
                        <div class="card card-stats card_2  mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">SOURCE API</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="apiTxtSource">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#fe8612;">
                                            <i class="fas fa-code-branch"></i>
                                        </div>
                                    </div>
                                </div>
                              <!--   <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="apiPercSource" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">API</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_3 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important"">SOURCE DATABASE</h5>
                                        <span class="h2 font-weight-bold mb-0" id="dbTxtSource" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow"  style="background-color:#058a22">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                 </div>
                              <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="dbPercSource"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">DATABASE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_4 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">SOURCE FILE</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="fileTxtSource">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#76407a;">
                                            <i class="fas fa-folder-open"></i>
                                        </div>
                                    </div>
                                </div>
                              <!--   <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="filePercSource" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">FILE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    `;
                $("#TransformerTransactionCards").html(headerCartTransformer);

                var headerCartCircleAmountTransformer = `
                 <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_1 mb-4 mb-xl-0 " style="height: 73px;background-color: #177a9a24;border:2px solid #177a9a; box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL DESTINATION</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalTxtDest" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color:#177a9a;">
                                            <i class="fas fa-globe"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercDest" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Destination</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6  col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_2  mb-4 mb-xl-0" style="height: 73px;background-color: #f1c0932b;border: 2px solid #fe8612;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION API</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="apiTxtDest">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color: #fe8612 ">
                                            <i class="fas fa-code-branch"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="apiPercDest" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">API</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_3 mb-4 mb-xl-0 " style="height: 73px;background-color: #058a2220;border: 2px solid #058a22;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION DATABASE</h5>
                                        <span class="h2 font-weight-bold mb-0" id="dbTxtDest" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color: #058a22 ">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="dbPercDest"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">DATABASE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_4 mb-4 mb-xl-0" style="height: 73px; background-color: #76407a29;border: 2px solid #76407a;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION FILE</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="fileTxtDest">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color: #76407a">
                                            <i class="fas fa-folder-open"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="filePercDest" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">FILE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                
                
                
                
                    
                    `;
                $("#TransformerAmountCards").html(headerCartCircleAmountTransformer);
            }
            LoadHeaderCardUITransformer()
            async function SetTransformerCardsData() {
                try {
                    let obj = {
                        "dateTime": formattedDate,//"2024-07-29",
                        "ApiType": "Transformer"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, Transformer } = apiResponse.SDT_ChartData;
                    const [objec] = Transformer;

                    //_______ Total and Amount _____
                    const { TotalSource, SourceAPI, SourceDB, SourceFILE, DestAPI, DestDB, DestFILE, TotalDest } = objec;
                    if (Transformer.length > 0) {
                        $("#totalTxtSource").text(TotalSource);
                        $("#apiTxtSource").text(SourceAPI);
                        $("#dbTxtSource").text(SourceDB);
                        $("#fileTxtSource").text(SourceFILE);

                        $("#totalTxtDest").text(TotalDest);
                        $("#apiTxtDest").text(DestAPI);
                        $("#dbTxtDest").text(DestDB);
                        $("#fileTxtDest").text(DestFILE);

                        // $(".totalTxtDest").text(formatCurrencyCash(TotalDest));
                        // $(".matchAmountTxtCash").text(formatCurrencyCash(MatchAmount));
                        // $(".proposedAmountTxtCash").text(formatCurrencyCash(ProposedAmount));
                        // $(".unMatchedAmountTxtCash").text(formatCurrencyCash(UnmatchAmount));

                    }

                    if (Total > 0) {
                        // Percentage
                        SapiPer = ((parseFloat(SourceAPI) / parseFloat(TotalSource)) * 100).toFixed(1) + '%';
                        SdbPer = ((parseFloat(SourceDB) / parseFloat(TotalSource)) * 100).toFixed(1) + '%';
                        SfilePer = ((parseFloat(SourceFILE) / parseFloat(TotalSource)) * 100).toFixed(1) + '%';

                        DapiPer = ((parseFloat(DestAPI) / parseFloat(TotalDest)) * 100).toFixed(1) + '%';
                        DdbPer = ((parseFloat(DestDB) / parseFloat(TotalDest)) * 100).toFixed(1) + '%';
                        DfilePer = ((parseFloat(DestFILE) / parseFloat(TotalDest)) * 100).toFixed(1) + '%';

                        $(".filePercSource").text(SfilePer);
                        $(".dbPercSource").text(SdbPer);
                        $(".apiPercSource").text(SapiPer);
                        $(".totalPercSource").text("100%");

                        $(".filePercDest").text(DfilePer);
                        $(".dbPercDest").text(DdbPer);
                        $(".apiPercDest").text(DapiPer);
                        $(".totalPercDest").text("100%");

                        //circle
                        $(".circle.totalCircle").attr("stroke-dasharray", (parseFloat(100) + ", 100"));
                        $(".circle.matchCircle").attr("stroke-dasharray", (parseFloat(SapiPer) + ", 100"));
                        $(".circle.proposedCircle").attr("stroke-dasharray", (parseFloat(SdbPer) + ", 100"));
                        $(".circle.unmatchedCircle").attr("stroke-dasharray", (parseFloat(SfilePer) + ", 100"));

                        //circle
                        $(".circle.totalCircleD").attr("stroke-dasharray", (parseFloat(100) + ", 100"));
                        $(".circle.matchCircleD").attr("stroke-dasharray", (parseFloat(DapiPer) + ", 100"));
                        $(".circle.proposedCircleD").attr("stroke-dasharray", (parseFloat(DdbPer) + ", 100"));
                        $(".circle.unmatchedCircleD").attr("stroke-dasharray", (parseFloat(DfilePer) + ", 100"));

                        //Progress   Class change krna wali rhteee haa
                        $(".progress_number_digital_total").text('100%');
                        $(".progress_number_digital_matched").text(SapiPer);
                        $(".progress_number_digital_proposed").text(SdbPer);
                        $(".progress_number_digital_unmatched").text(SfilePer);


                        //Progress   Class change krna wali rhteee haa
                        $(".progress_number_digital_totalD").text('100%');
                        $(".progress_number_digital_matchedD").text(DapiPer);
                        $(".progress_number_digital_proposedD").text(DdbPer);
                        $(".progress_number_digital_unmatchedD").text(DfilePer);

                        $(".progress-bar-inner-total-digital").css("width", '100%');
                        $(".progress-bar-inner-matched-digital").css("width", SapiPer);
                        $(".progress-bar-inner-proposed-digital").css("width", SdbPer);
                        $(".progress-bar-inner-unmatched-digital").css("width", SfilePer);

                        $(".progress-bar-inner-total-digitalD").css("width", '100%');
                        $(".progress-bar-inner-matched-digitalD").css("width", DapiPer);
                        $(".progress-bar-inner-proposed-digitalD").css("width", DdbPer);
                        $(".progress-bar-inner-unmatched-digitalD").css("width", DfilePer);
                    }

                } catch (error) {
                    showTransformerChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            SetTransformerCardsData();
            function formatCurrencyTransformer(amount) {
                const formatter = new Intl.NumberFormat('en-PK', {
                    style: 'currency',
                    currency: 'PKR',
                });
                return formatter.format(amount);
            }
        }
        LoadCardsTransformer()


        //________________________________________________________
        //______________________ Chart ___________________________
        //________________________________________________________
        function Transformerchart() {
            document.getElementById('TransformerOverAllChartType4').addEventListener('change', function () {
                updateChartTransformer('EltDataLoadingFileChart', this.value);
            });
            document.getElementById('DBChartLoadType').addEventListener('change', function () {
                updateChartTransformer('DBChartLoad', this.value);
            });
            document.getElementById('APIUploadChartType').addEventListener('change', function () {
                updateChartTransformer('APIUploadChart', this.value);
            });
            document.getElementById('TransformerOverAllChartType3').addEventListener('change', function () {
                updateChartTransformer('TransformerOverAllDestCount', this.value);
            });
            document.getElementById('TransformerOverAllChartType2').addEventListener('change', function () {
                updateChartTransformer('TransformerOverAllSourceCount', this.value);
            });


            function updateChartTransformer(chartId, chartType) {
                if (chartId == "EltDataLoadingFileChart") {
                    EltDataLoadingFileChart(chartId, chartType, 0, "Admin", "ELT File Loading");
                }
                else if (chartId == "DBChartLoad") {
                    DBChartLoad(chartId, chartType, 0, "Admin", "DB Loading");
                }
                else if (chartId == "APIUploadChart") {
                    APIUploadChart(chartId, chartType, 0, "Admin", "API Loading");
                }
                else if (chartId == "TransformerOverAllDestCount") {
                    TransformerOverAllDestCount(chartId, chartType);
                }
                else if (chartId == "TransformerOverAllSourceCount") {
                    TransformerOverAllSourceCount(chartId, chartType);
                }

            }
            //------------------------------------
            //---- EltDataLoadingFileChart -------
            //------------------------------------
            async function EltDataLoadingFileChartAPIRequest() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Transformer"
                    };

                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { TransformerChart1 } = apiResponse.SDT_ChartData;


                    const seriesData = [];
                    const xAxisCategories = ['Record Read', 'Record Loaded'];
                    let successRead = 0, failedRead = 0, successLoaded = 0, failedLoaded = 0;
                    TransformerChart1.forEach(item => {
                        if (item.TransformerChart1Status === 'Success') {
                            successRead = item.TransformerChart1RecordRead;
                            successLoaded = item.TransformerChart1RecordLoaded;
                        } else if (item.TransformerChart1Status === 'Faild' || item.TransformerChart1Status === 'Failed') {
                            failedRead = item.TransformerChart1RecordRead;
                            failedLoaded = item.TransformerChart1RecordLoaded;
                        }
                    });
                    seriesData.push({
                        name: 'Success',
                        data: [successRead, successLoaded]
                    });
                    seriesData.push({
                        name: 'Failed',
                        data: [failedRead, failedLoaded]
                    });



                    return {
                        series: seriesData,
                        xAxis: { categories: xAxisCategories }
                    };
                    // return {
                    //                 series: [
                    //                     { name: 'Overview', data: seriesData }
                    //                 ],
                    //             };
                } catch (error) {
                    showTransformerChartHideLoader()
                    console.error('Error fetching data:', error);
                }
            }
            async function EltDataLoadingFileChart(containerId, chartType, matchType, roleName, title) {
                const data = await EltDataLoadingFileChartAPIRequest(matchType, roleName);

                // If no valid data is available, exit the function
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }


                // Convert the string data to integers for proper chart rendering
                const successData = data.series.find(item => item.name === 'Success').data.map(val => parseInt(val, 10));
                const failedData = data.series.find(item => item.name === 'Failed').data.map(val => parseInt(val, 10));

                // Set chart options
                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#b9b26a'], // Green for success, red for failure
                    chart: {
                        renderTo: containerId,
                        type: chartType, // Specify the chart type (e.g., column, pie, etc.)
                        backgroundColor: 'rgba(255, 255, 255, 0.1)' // Chart background color
                    },
                    title: {
                        text: title,
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: {
                        categories: data.xAxis.categories, // Set categories from the API response
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Number of Records',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                // format: '{point.y}', // Display the value of the data point
                                formatter: function () {
                                    // Hide labels for points with value 0
                                    return this.y !== 0 ? this.y : null;
                                },
                                style: {
                                    color: '#000000'
                                }
                            }
                        }
                    },
                    series: [
                        {
                            name: 'Success', // Series for Success
                            data: successData // Use the converted success data
                        },
                        {
                            name: 'Failed', // Series for Failed
                            data: failedData // Use the converted failed data
                        }
                    ]
                };

                // Create the chart
                var chart = new Highcharts.Chart(chartOptions);

                // Handle chart type change (e.g., column to pie)
                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType // Update the chart type dynamically
                        }
                    });
                });
            }
            EltDataLoadingFileChart("EltDataLoadingFileChart", "bar", 0, "Admin", "ELT File Loading");


            //------------------------------------
            //---- Db records chart -------
            //------------------------------------
            async function DBChartLoadAPIRequest() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Transformer"
                    };

                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();

                    const { TransformerChart1 } = apiResponse.SDT_ChartData;
                    const seriesData = [];
                    const xAxisCategories = ['DB Count'];
                    let successDBLoad = 0, failedDBLoad = 0;
                    TransformerChart1.forEach(item => {
                        if (item.TransformerChart1Status === 'Success' && item.TransformerChart1ChartType === 'Source' && item.TransformerChart1SrcType === 'DB') {
                            successDBLoad = item.TransformerChart1RecordLoaded;

                        } else {
                            failedDBLoad = item.TransformerChart1RecordLoaded;

                        }
                    });
                    seriesData.push({
                        name: 'Success',
                        data: [successDBLoad]
                    });
                    seriesData.push({
                        name: 'Failed',
                        data: [failedDBLoad]
                    });



                    return {
                        series: seriesData,
                        xAxis: { categories: xAxisCategories }
                    };
                    // return {
                    //                 series: [
                    //                     { name: 'Overview', data: seriesData }
                    //                 ],
                    //             };
                } catch (error) {
                    showTransformerChartHideLoader()
                    console.error('Error fetching data:', error);
                }
            }
            async function DBChartLoad(containerId, chartType, matchType, roleName, title) {
                const data = await DBChartLoadAPIRequest(matchType, roleName);

                // If no valid data is available, exit the function
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }

                // Convert the string data to integers for proper chart rendering
                const successData = data.series.find(item => item.name === 'Success').data.map(val => parseInt(val, 10));
                const failedData = data.series.find(item => item.name === 'Failed').data.map(val => parseInt(val, 10));
                let series;

                if (chartType === 'pie') {
                    // Adjust the data for pie chart
                    series = [{
                        name: 'Status',
                        colorByPoint: true,
                        data: [
                            { name: 'Success', y: successData[0] || 0 },
                            { name: 'Failed', y: failedData[0] || 0 }
                        ]
                    }];
                } else {
                    // Use data as-is for column/bar
                    series = [
                        {
                            name: 'Success',
                            data: successData
                        },
                        {
                            name: 'Failed',
                            data: failedData
                        }
                    ];
                }

                // Set chart options
                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#b9b26a'], // Green for success, red for failure
                    chart: {
                        renderTo: containerId,
                        type: chartType, // Specify the chart type (e.g., column, pie, etc.)
                        backgroundColor: 'rgba(255, 255, 255, 0.1)' // Chart background color
                    },
                    title: {
                        text: title,
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: chartType === 'pie' ? undefined : {
                        categories: data.xAxis.categories, // Set categories from the API response
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: chartType === 'pie' ? undefined : {
                        title: {
                            text: 'Number of Records',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.y}', // Display "Success: 10" or "Failed: 5"
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                formatter: function () {
                                    // Include the series name and value
                                    return this.y !== 0 ? `${this.series.name}: ${this.y}` : null; // Example: "Success: 10"
                                },
                                style: {
                                    color: '#000000'
                                }
                            }
                        }
                    },
                    series: series
                };

                // Create the chart
                var chart = new Highcharts.Chart(chartOptions);

                // Handle chart type change (e.g., column to pie)
                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType // Update the chart type dynamically
                        }
                    });
                });
            }
            DBChartLoad("DBChartLoad", "column", 0, "Admin", "DB Loading");


            async function APIUploadChartAPIRequest() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Transformer"
                    };

                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();


                    const { TransformerChart1 } = apiResponse.SDT_ChartData;
                    const seriesData = [];
                    const xAxisCategories = ['API Count'];
                    let successDBLoad = 0, failedDBLoad = 0;
                    TransformerChart1.forEach(item => {
                        if (item.TransformerChart1Status === 'Success' && item.TransformerChart1ChartType === 'Source' && item.TransformerChart1SrcType === 'API') {
                            successDBLoad = item.TransformerChart1RecordLoaded;

                        } else {
                            failedDBLoad = item.TransformerChart1RecordLoaded;

                        }
                    });
                    seriesData.push({
                        name: 'Success',
                        data: [successDBLoad]
                    });
                    seriesData.push({
                        name: 'Failed',
                        data: [failedDBLoad]
                    });



                    return {
                        series: seriesData,
                        xAxis: { categories: xAxisCategories }
                    };
                    // return {
                    //                 series: [
                    //                     { name: 'Overview', data: seriesData }
                    //                 ],
                    //             };
                } catch (error) {
                    showTransformerChartHideLoader()
                    console.error('Error fetching data:', error);
                }
            }

            async function APIUploadChart(containerId, chartType, matchType, roleName, title) {
                const data = await APIUploadChartAPIRequest(matchType, roleName);

                // If no valid data is available, exit the function
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }

                // Convert the string data to integers for proper chart rendering
                const successData = data.series.find(item => item.name === 'Success').data.map(val => parseInt(val, 10));
                const failedData = data.series.find(item => item.name === 'Failed').data.map(val => parseInt(val, 10));
                let series;

                if (chartType === 'pie') {
                    // Adjust the data for pie chart
                    series = [{
                        name: 'Status',
                        colorByPoint: true,
                        data: [
                            { name: 'Success', y: successData[0] || 0 },
                            { name: 'Failed', y: failedData[0] || 0 }
                        ]
                    }];
                } else {
                    // Use data as-is for column/bar
                    series = [
                        {
                            name: 'Success',
                            data: successData
                        },
                        {
                            name: 'Failed',
                            data: failedData
                        }
                    ];
                }

                // Set chart options
                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#b9b26a'], // Green for success, red for failure
                    chart: {
                        renderTo: containerId,
                        type: chartType, // Specify the chart type (e.g., column, pie, etc.)
                        backgroundColor: 'rgba(255, 255, 255, 0.1)' // Chart background color
                    },
                    title: {
                        text: title,
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: chartType === 'pie' ? undefined : {
                        categories: data.xAxis.categories, // Set categories from the API response
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: chartType === 'pie' ? undefined : {
                        title: {
                            text: 'Number of Records',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.y}', // Display "Success: 10" or "Failed: 5"
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                formatter: function () {
                                    // Include the series name and value
                                    return this.y !== 0 ? `${this.series.name}: ${this.y}` : null; // Example: "Success: 10"
                                },
                                style: {
                                    color: '#000000'
                                }
                            }
                        }
                    },
                    series: series
                };

                // Create the chart
                var chart = new Highcharts.Chart(chartOptions);

                // Handle chart type change (e.g., column to pie)
                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType // Update the chart type dynamically
                        }
                    });
                });
            }



            APIUploadChart("APIUploadChart", "bar", 0, "Admin", "API Loading");



            async function fetchTransformerChartDataOverAllSource() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Transformer"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, Transformer } = apiResponse.SDT_ChartData;
                    const [objec] = Transformer;
                    const { TotalSource, SourceAPI, SourceDB, SourceFILE, DestAPI, DestDB, DestFILE, TotalDest } = objec;

                    const seriesData = [];

                    // Fix y values to two decimal places
                    seriesData.push({
                        name: 'SourceFILE',
                        y: parseFloat(((SourceFILE / TotalSource) * 100).toFixed(2))
                    });
                    seriesData.push({
                        name: 'SourceAPI',
                        y: parseFloat(((SourceAPI / TotalSource) * 100).toFixed(2))
                    });
                    seriesData.push({
                        name: 'SourceDB',
                        y: parseFloat(((SourceDB / TotalSource) * 100).toFixed(2))
                    });

                    return {
                        series: [
                            { name: 'Overview', data: seriesData }
                        ],
                    };
                } catch (error) {
                    showTransformerChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function TransformerOverAllSourceCount(containerId, chartType, matchType, roleName) {
                const data = await fetchTransformerChartDataOverAllSource(matchType, roleName);
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }
                else {
                    //$("." + containerId).show();
                }

                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                    chart: {
                        renderTo: containerId,
                        type: chartType,
                        backgroundColor: 'rgba(255, 255, 255, 0.1)',
                        events: {
                            drilldown: function (e) {
                                //alert('Drilled down to ' + e.point.name);
                            }
                        }
                    },
                    title: {
                        text: 'Overall Source Count',
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Values',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.y:.1f}%',
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        pie: {
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Source',
                        colorByPoint: true,
                        data: data.series[0].data
                    }],

                };

                var chart = new Highcharts.Chart(chartOptions);

                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value.toFixed(2);
                    chart.update({
                        chart: {
                            type: newType
                        }
                    });
                });
            }
            TransformerOverAllSourceCount("TransformerOverAllSourceCount", "line", 0, "Admin");

            //----------------------------
            //---- Over All Chart Destination------
            //----------------------------
            async function fetchTransformerChartDataOverAllDest() {
                try {
                    let obj = {
                        "dateTime": formattedDate,
                        "ApiType": "Transformer"
                    };
                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, Transformer } = apiResponse.SDT_ChartData;
                    const [objec] = Transformer;
                    const { TotalSource, SourceAPI, SourceDB, SourceFILE, DestAPI, DestDB, DestFILE, TotalDest } = objec;

                    const seriesData = [];

                    seriesData.push({
                        name: 'DestFILE',
                        y: (DestFILE / TotalDest) * 100
                    });
                    seriesData.push({
                        name: 'DestAPI',
                        y: (DestAPI / TotalDest) * 100
                    });
                    seriesData.push({
                        name: 'DestDB',
                        y: (DestDB / TotalDest) * 100
                    });

                    return {
                        series: [
                            { name: 'Overview', data: seriesData }
                        ],
                    };
                } catch (error) {
                    showTransformerChartHideLoader()
                    console.log('Error fetching data:' + error);
                }
            }
            async function TransformerOverAllDestCount(containerId, chartType, matchType, roleName) {
                const data = await fetchTransformerChartDataOverAllDest(matchType, roleName);
                if (!data || !data.series || data.series.length === 0) {
                    return;
                }
                else {
                    //$("." + containerId).show();
                }

                var chartOptions = {
                    colors: ['var(--colors_materialmenu_selecteditembackground)', '#434348', '#90ed7d', '#f7a35c'],
                    chart: {
                        renderTo: containerId,
                        type: chartType,
                        backgroundColor: 'rgba(255, 255, 255, 0.1)',
                        events: {
                            drilldown: function (e) {
                                //alert('Drilled down to ' + e.point.name);
                            }
                        }
                    },
                    title: {
                        text: 'Overall Destination Count',
                        style: {
                            color: 'var(--colors_materialmenu_selecteditembackground)',
                            fontSize: '20px'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Values',
                            style: {
                                color: 'var(--colors_materialmenu_selecteditembackground)',
                                fontSize: '16px'
                            }
                        },
                        labels: {
                            style: {
                                color: '#4CAF50'
                            }
                        }
                    },
                    legend: {
                        enabled: true,
                        itemStyle: {
                            color: '#4CAF50'
                        }
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.y:.1f}%',
                                style: {
                                    color: '#000000'
                                }
                            }
                        },
                        pie: {
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Destination',
                        colorByPoint: true,
                        data: data.series[0].data
                    }],

                };

                var chart = new Highcharts.Chart(chartOptions);

                document.getElementById('chartType').addEventListener('change', function () {
                    var newType = this.value;
                    chart.update({
                        chart: {
                            type: newType
                        }
                    });
                });
            }
            TransformerOverAllDestCount("TransformerOverAllDestCount", "pie", 0, "Admin");


        }
        Transformerchart();
    }


    //________________________________________
    //______________ Settlement ____________________
    //________________________________________
    function Settlement() {
        //________________________________________________________
        //______________________ Commons _________________________
        //________________________________________________________
        hideSettlementCharts();
        function hideSettlementCharts() {
            $(".EltDataLoadingFileChart").hide();
            $(".APIUploadChart").hide();
            $(".DBChartLoad").hide();
            $(".SettlementOverAllChart1").hide();
            $(".SettlementOverAllDestCount").hide();
            $(".SettlementOverAllSourceCount").hide();
            $(".SettlementAggingChart").hide();
            $(".SettlementDisputeChart").hide();
            $(".SettlementDisputeAgingChart").hide();
        }
        function showSettlementChartHideLoader() {
            $(".chart-containers").hide();
            $(".SettlementDisputeChart").show();
            $(".SettlementAggingChart").show();
            $(".EltDataLoadingFileChart").show();
            $(".DBChartLoad").show();
            $(".APIUploadChart").show();
            $(".SettlementOverAllChart1").show();
            $(".SettlementOverAllDestCount").show();
            $(".SettlementOverAllSourceCount").show();
            $(".SettlementDisputeAgingChart").show();
        }

        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().split('T')[0];
        //const formattedDate = "2024-08-22"

        const lastWeekDate = new Date(currentDate);
        lastWeekDate.setDate(currentDate.getDate() - 7);
        const formattedDateLastWeek = lastWeekDate.toISOString().split('T')[0];


        //________________________________________________________
        //______________________ Cards ___________________________
        //________________________________________________________
        function LoadCardsSettlement() {
            function LoadHeaderCardUISettlement() {
                var headerCartSettlement = `
                    <div class="col-xl-4 col-lg-4 col-sm-6">
                        <div class="card card-stats card_1 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body" >
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL PROCESS</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalProcess" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#177a9a;">
                                            <i class="fas fa-globe"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercSource" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Pre Voucher</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-4  col-sm-6">
                        <div class="card card-stats card_2  mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">Total Voucher</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="totalPreVoucher">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#fe8612;">
                                            <i class="fas fa-code-branch"></i>
                                        </div>
                                    </div>
                                </div>
                              <!--   <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="apiPercSource" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">API</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-sm-6">
                        <div class="card card-stats card_3 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important"">Total Voucher AMOUNT</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalPreVoucherAmt" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow"  style="background-color:#058a22">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                 </div>
                              <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="dbPercSource"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">DATABASE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="display:none;">
                        <div class="card card-stats card_4 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">SOURCE FILE</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="fileTxtSource">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#76407a;">
                                            <i class="fas fa-folder-open"></i>
                                        </div>
                                    </div>
                                </div>
                              <!--   <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="filePercSource" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">FILE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    `;
                $("#SettlementTransactionCards").html(headerCartSettlement);

                var headerCartCircleAmountSettlement = `
                 <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px;display:none;">
                        <div class="card card-stats card_1 mb-4 mb-xl-0 " style="height: 73px;background-color: #177a9a24;border:2px solid #177a9a; box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL VOUCHER</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalVoucher" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color:#177a9a;">
                                            <i class="fas fa-globe"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercDest" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Voucher Amount</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6  col-sm-6" style="margin-top:15px;display:none;">
                        <div class="card card-stats card_2  mb-4 mb-xl-0" style="height: 73px;background-color: #f1c0932b;border: 2px solid #fe8612;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL VOUCHER AMOUNT</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="totalVoucherAmt">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color: #fe8612 ">
                                            <i class="fas fa-code-branch"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="apiPercDest" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">API</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px;display:none;">
                        <div class="card card-stats card_3 mb-4 mb-xl-0 " style="height: 73px;background-color: #058a2220;border: 2px solid #058a22;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION DATABASE</h5>
                                        <span class="h2 font-weight-bold mb-0" id="dbTxtDest" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color: #058a22 ">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="dbPercDest"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">DATABASE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px;display:none;">
                        <div class="card card-stats card_4 mb-4 mb-xl-0" style="height: 73px; background-color: #76407a29;border: 2px solid #76407a;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION FILE</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="fileTxtDest">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color: #76407a">
                                            <i class="fas fa-folder-open"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="filePercDest" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">FILE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                
                
                
                
                    
                    `;
                $("#SettlementAmountCards").html(headerCartCircleAmountSettlement);
            }
            LoadHeaderCardUISettlement()
            async function SetSettlementCardsData() {


                try {
                    let obj = {
                        "dateTime": formattedDate, // "2024-07-29",
                        "ApiType": "Settlement"
                    };

                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: {
                            "Content-type": "application/json; charset=UTF-8",
                            'Authorization': token
                        },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();
                    const { Data, Level1, Level2, Level3, SettlementStatistics } = apiResponse.SDT_ChartData;
                    const [objec] = SettlementStatistics;
                    //_______ Total and Amount _____
                    const { SettlementChartId, SettlementStatisticsProcess, SettlementStatisticsPreTotalVoucher, SettlementStatisticsPreTotalAmount, SettlementStatisticsTotalVoucher, SettlementStatisticsTotalAmount } = objec;
                    if (SettlementStatistics.length > 0) {
                        $("#totalProcess").text(SettlementStatisticsProcess);
                        $("#totalPreVoucher").text(SettlementStatisticsPreTotalVoucher);
                        $("#totalPreVoucherAmt").text(SettlementStatisticsPreTotalAmount);
                        $("#totalVoucher").text(SettlementStatisticsTotalVoucher);
                        $("#totalVoucherAmt").text(SettlementStatisticsTotalAmount);


                        $("#fileTxtSource").text(DestDB);

                        // $("#totalVoucher").text(SettlementStatisticsTotalVoucher);
                        // $("#totalVoucherAmt").text(SettlementStatisticsTotalAmount);
                        $("#dbTxtDest").text(DestDB);
                        $("#fileTxtDest").text(DestFILE);

                        // $(".totalTxtDest").text(formatCurrencyCash(TotalDest));
                        // $(".matchAmountTxtCash").text(formatCurrencyCash(MatchAmount));
                        // $(".proposedAmountTxtCash").text(formatCurrencyCash(ProposedAmount));
                        // $(".unMatchedAmountTxtCash").text(formatCurrencyCash(UnmatchAmount));

                    }
                } catch (error) {
                    showSettlementChartHideLoader();
                    console.log('Error fetching data:', error);
                }
            }
            SetSettlementCardsData();
            function formatCurrencySettlement(amount) {
                const formatter = new Intl.NumberFormat('en-PK', {
                    style: 'currency',
                    currency: 'PKR',
                });
                return formatter.format(amount);
            }
        }
        LoadCardsSettlement()
    }


    //________________________________________
    //______________ Settlement ____________________
    //________________________________________
    function Dispute() {
        //________________________________________________________
        //______________________ Commons _________________________
        //________________________________________________________
        hideDisputeCharts();
        function hideDisputeCharts() {
            $(".EltDataLoadingFileChart").hide();
            $(".APIUploadChart").hide();
            $(".DBChartLoad").hide();
            $(".DisputeOverAllChart1").hide();
            $(".DisputeOverAllDestCount").hide();
            $(".DisputeOverAllSourceCount").hide();
            $(".DisputeAggingChart").hide();
            $(".DisputeDisputeChart").hide();
            $(".DisputeDisputeAgingChart").hide();
        }
        function showDisputeChartHideLoader() {
            $(".chart-containers").hide();
            $(".DisputeDisputeChart").show();
            $(".DisputeAggingChart").show();
            $(".EltDataLoadingFileChart").show();
            $(".DBChartLoad").show();
            $(".APIUploadChart").show();
            $(".DisputeOverAllChart1").show();
            $(".DisputeOverAllDestCount").show();
            $(".DisputeOverAllSourceCount").show();
            $(".DisputeDisputeAgingChart").show();
        }

        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().split('T')[0];
        //const formattedDate = "2024-08-22"

        const lastWeekDate = new Date(currentDate);
        lastWeekDate.setDate(currentDate.getDate() - 7);
        const formattedDateLastWeek = lastWeekDate.toISOString().split('T')[0];


        //________________________________________________________
        //______________________ Cards ___________________________
        //________________________________________________________
        function LoadCardsDispute() {
            function LoadHeaderCardUIDispute() {
                var headerCartDispute = `
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_1 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body" >
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL PROCESS</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalProcess" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#177a9a;">
                                            <i class="fas fa-globe"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercSource" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Voucher</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6  col-sm-6">
                        <div class="card card-stats card_2  mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">Total Voucher</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="totalPreVoucher">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#fe8612;">
                                            <i class="fas fa-code-branch"></i>
                                        </div>
                                    </div>
                                </div>
                              <!--   <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="apiPercSource" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">API</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_3 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important"">Total AMOUNT</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalPreVoucherAmt" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow"  style="background-color:#058a22">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                 </div>
                              <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="dbPercSource"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">DATABASE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="card card-stats card_4 mb-4 mb-xl-0" style="height: 73px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">SOURCE FILE</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="fileTxtSource">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color:#76407a;">
                                            <i class="fas fa-folder-open"></i>
                                        </div>
                                    </div>
                                </div>
                              <!--   <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="filePercSource" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">FILE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    `;
                $("#DisputeTransactionCards").html(headerCartDispute);

                var headerCartCircleAmountDispute = `
                 <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_1 mb-4 mb-xl-0 " style="height: 73px;background-color: #177a9a24;border:2px solid #177a9a; box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL VOUCHER</h5>
                                        <span class="h2 font-weight-bold mb-0" id="totalVoucher" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color:#177a9a;">
                                            <i class="fas fa-globe"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fa fa-arrow-up" style="color: #177a9a"></i> <b class="totalPercDest" style="color: #177a9a">0%</b></span>
                                    <span class="text-nowrap" style="color:black">Total Voucher Amount</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6  col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_2  mb-4 mb-xl-0" style="height: 73px;background-color: #f1c0932b;border: 2px solid #fe8612;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">TOTAL AMOUNT</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="totalVoucherAmt">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape text-white rounded-circle shadow" style="background-color: #fe8612 ">
                                            <i class="fas fa-code-branch"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-danger mr-2"><i class="fas fa-arrow-down" style="color: #fe8612 "></i> <b class="apiPercDest" style="color: #fe8612 ">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">API</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_3 mb-4 mb-xl-0 " style="height: 73px;background-color: #058a2220;border: 2px solid #058a22;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION</h5>
                                        <span class="h2 font-weight-bold mb-0" id="dbTxtDest" style="color:black !important">0</span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color: #058a22 ">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-warning mr-2"><i class="fas fa-arrow-down" style="color:#058a22 !important"></i> <b style="color:#058a22 !important" class="dbPercDest"> 0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">DATABASE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6" style="margin-top:15px">
                        <div class="card card-stats card_4 mb-4 mb-xl-0" style="height: 73px; background-color: #76407a29;border: 2px solid #76407a;box-shadow: 2px 2px 5px #00000063;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <h5 class="card-title text-uppercase text-muted mb-0" style="color:black !important">DESTINATION FILE</h5>
                                        <span class="h2 font-weight-bold mb-0" style="color:black !important" id="fileTxtDest">0</span>

                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape  text-white rounded-circle shadow" style="background-color: #76407a">
                                            <i class="fas fa-folder-open"></i>
                                        </div>
                                    </div>
                                </div>
                               <!--  <p class="mt-3 mb-0 text-muted text-sm" style="margin-top:2px !important">
                                    <span class="text-success mr-2"><i class="fas fa-arrow-up" style="color: #76407a"></i> <b class="filePercDest" style="color: #76407a">0%</b></span>
                                    <span class="text-nowrap" style="color:black !important">FILE</span>
                                </p>-->
                            </div>
                        </div>
                    </div>
                
                
                
                
                    
                    `;
                $("#DisputeAmountCards").html(headerCartCircleAmountDispute);
            }
            LoadHeaderCardUIDispute()
            async function SetDisputeCardsData() {


                try {
                    let obj = {
                        "dateTime": formattedDate, // "2024-07-29",
                        "ApiType": "Dispute"
                    };

                    const response = await fetch('rest/prDataStatisticeAPI', {
                        method: 'POST',
                        headers: {
                            "Content-type": "application/json; charset=UTF-8",
                            'Authorization': token
                        },
                        body: JSON.stringify(obj)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const apiResponse = await response.json();

                    // Extract necessary data from the response
                    const { Data, Level1, Level2, Level3, SettlementStatistics } = apiResponse.SDT_ChartData;
                    const [objec] = SettlementStatistics;
                    //_______ Total and Amount _____
                    const { SettlementChartId, SettlementStatisticsProcess, SettlementStatisticsPreTotalVoucher, SettlementStatisticsPreTotalAmount, SettlementStatisticsTotalVoucher, SettlementStatisticsTotalAmount } = objec;
                    if (SettlementStatistics.length > 0) {
                        $("#totalProcess").text(SettlementStatisticsProcess);
                        $("#totalPreVoucher").text(SettlementStatisticsPreTotalVoucher);
                        $("#totalPreVoucherAmt").text(SettlementStatisticsPreTotalAmount);
                        $("#totalVoucher").text(SettlementStatisticsTotalVoucher);
                        $("#totalVoucherAmt").text(SettlementStatisticsTotalAmount);


                        $("#fileTxtSource").text(DestDB);

                        // $("#totalVoucher").text(SettlementStatisticsTotalVoucher);
                        // $("#totalVoucherAmt").text(SettlementStatisticsTotalAmount);
                        $("#dbTxtDest").text(DestDB);
                        $("#fileTxtDest").text(DestFILE);

                        // $(".totalTxtDest").text(formatCurrencyCash(TotalDest));
                        // $(".matchAmountTxtCash").text(formatCurrencyCash(MatchAmount));
                        // $(".proposedAmountTxtCash").text(formatCurrencyCash(ProposedAmount));
                        // $(".unMatchedAmountTxtCash").text(formatCurrencyCash(UnmatchAmount));

                    }
                } catch (error) {
                    showDisputeChartHideLoader();
                    console.log('Error fetching data:', error);
                }
            }
            SetDisputeCardsData();
            function formatCurrencyDispute(amount) {
                const formatter = new Intl.NumberFormat('en-PK', {
                    style: 'currency',
                    currency: 'PKR',
                });
                return formatter.format(amount);
            }
        }
        LoadCardsDispute();
    }


    //________________________________________
    //___________ Refresh Chart ______________
    //________________________________________
    function RefreshModule(moduleType, isRefresh) {
        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().split('T')[0];
        fetchChartDataOverAll(moduleType)
        async function fetchChartDataOverAll() {
            try {
                let obj = {
                    "dateTime": formattedDate,
                    "ApiType": moduleType,
                    "Refresh": 1
                };
                const response = await fetch('rest/prDataStatisticeAPI', {
                    method: 'POST',
                    headers: { "Content-type": "application/json; charset=UTF-8", 'Authorization': token },
                    body: JSON.stringify(obj)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Debugging - check if response was successful
                if (isRefresh) {
                    location.reload();
                }

            } catch (error) {
                showDigitalChartHideLoader();
                console.log('Error fetching data: ' + error.message);
            }
        }
    }

    //________________________________________
    //____________ Refresh page ______________
    //________________________________________
    let reloadFlag = document.cookie.includes('reloadFlag=true');
    if (!reloadFlag) { document.cookie = 'reloadFlag=true;max-age=60'; setTimeout(function () { window.location.reload(); }, 0.5); } else { document.cookie = 'reloadFlag=;max-age=0'; }

</script>